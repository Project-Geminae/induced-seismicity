2025-06-04 11:46:22,609 - INFO - 
=====================================================================
 S E I S M I C   A N A L Y S I S   P I P E L I N E
=====================================================================
Start time: 2025-06-04 11:46:22
Radius values: 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0 km
=====================================================================
    
2025-06-04 11:46:22,609 - INFO - 
STEP 0 · ENVIRONMENT & CONSTANTS
───────────────────────────────────────────────────────────────────
| Parameter                    | Value                            |
|------------------------------|----------------------------------|
| Geographic CRS               | EPSG 4326  (WGS-84)              |
| Planar CRS for distances     | EPSG 3857  (Web Mercator)        |
| Well–event link distance     | 2, 5, 10, 15, 20 km (varied)     |
| Fault-segment length         | ~1 km                            |
| Injection look-back window   | 30 days                          |
| Random seed (DoWhy)          | 42                               |
    
2025-06-04 11:46:22,609 - INFO - 
################################################################################
2025-06-04 11:46:22,609 - INFO - # STEP 1: IMPORT & FILTER RAW TABLES
2025-06-04 11:46:22,610 - INFO - ################################################################################

2025-06-04 11:46:22,610 - INFO - ======================================================================
2025-06-04 11:46:22,610 - INFO - Running: swd_data_import.py
2025-06-04 11:46:22,610 - INFO - Purpose: Subset SWD records → swd_data_filtered.csv (650,374 rows × 7 cols)
2025-06-04 11:46:22,610 - INFO - ======================================================================
2025-06-04 11:46:27,839 - INFO - Output:

📈  BEFORE bounding-box filter — summary
   Rows .................... 828,149
   Unique wells (API) ...... 918
   Date range .............. 2016-02-01 → 2025-06-30
   Total injected (BBL) .... 5,130,205,573
   Mean avg pressure (PSI).. 718.8

📈  AFTER  bounding-box filter — summary
   Rows .................... 663,917
   Unique wells (API) ...... 687
   Date range .............. 2016-02-01 → 2025-06-30
   Total injected (BBL) .... 3,600,477,107
   Mean avg pressure (PSI).. 742.7

🔎  First 5 wells INSIDE the Midland Basin:

   API Number Date of Injection  ...  Surface Longitude  Surface Latitude
0    31741196        2016-02-01  ...        -101.693842         32.458954
1    31741196        2016-02-02  ...        -101.693842         32.458954
2    31741196        2016-02-03  ...        -101.693842         32.458954
3    31741196        2016-02-04  ...        -101.693842         32.458954
4    31741196        2016-02-05  ...        -101.693842         32.458954

[5 rows x 7 columns]

💾  Filtered data saved → swd_data_filtered.csv (663,917 rows)

2025-06-04 11:46:27,839 - INFO - ✓ Completed swd_data_import.py in 5.23 seconds

2025-06-04 11:46:27,839 - INFO - ======================================================================
2025-06-04 11:46:27,839 - INFO - Running: seismic_data_import.py
2025-06-04 11:46:27,839 - INFO - Purpose: Subset TexNet catalog → texnet_events_filtered.csv (6,064 rows × 7 cols)
2025-06-04 11:46:27,840 - INFO - ======================================================================
2025-06-04 11:46:28,602 - INFO - Output:
✅  Saved filtered catalog → texnet_events_filtered.csv (6,264 rows)
🖼️  Event map saved → midland_basin_events_map.png

2025-06-04 11:46:28,603 - INFO - ✓ Completed seismic_data_import.py in 0.76 seconds

2025-06-04 11:46:28,603 - INFO - 
################################################################################
2025-06-04 11:46:28,603 - INFO - # STEP 2: SPATIAL JOIN (WELLS ↔ EVENTS)
2025-06-04 11:46:28,603 - INFO - ################################################################################

2025-06-04 11:46:28,603 - INFO - ======================================================================
2025-06-04 11:46:28,603 - INFO - Running: merge_seismic_swd.py
2025-06-04 11:46:28,603 - INFO - Purpose: Create event-well links for radii: 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0 km
2025-06-04 11:46:28,603 - INFO - ======================================================================
2025-06-04 11:47:35,871 - INFO - Output:
2025-06-04 11:46:29,028  INFO      📄  Loaded swd_data_filtered.csv        →  663917 rows × 4 cols
2025-06-04 11:46:29,038  INFO      🔧  Deduplicated wells: 663917 → 687 unique APIs
2025-06-04 11:46:29,042  INFO      📄  Loaded texnet_events_filtered.csv   →    6264 rows × 7 cols
2025-06-04 11:46:29,042  INFO      🔗  Linking wells to events for radii: [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0] km
2025-06-04 11:47:22,855  INFO      💾  1.0 km CSV written → event_well_links_1km.csv  (1177 rows)
2025-06-04 11:47:22,951  INFO      💾  2.0 km CSV written → event_well_links_2km.csv  (4775 rows)
2025-06-04 11:47:23,112  INFO      💾  3.0 km CSV written → event_well_links_3km.csv  (11645 rows)
2025-06-04 11:47:23,330  INFO      💾  4.0 km CSV written → event_well_links_4km.csv  (20274 rows)
2025-06-04 11:47:23,600  INFO      💾  5.0 km CSV written → event_well_links_5km.csv  (30417 rows)
2025-06-04 11:47:23,887  INFO      💾  6.0 km CSV written → event_well_links_6km.csv  (42127 rows)
2025-06-04 11:47:24,226  INFO      💾  7.0 km CSV written → event_well_links_7km.csv  (55872 rows)
2025-06-04 11:47:24,612  INFO      💾  8.0 km CSV written → event_well_links_8km.csv  (71996 rows)
2025-06-04 11:47:25,054  INFO      💾  9.0 km CSV written → event_well_links_9km.csv  (90575 rows)
2025-06-04 11:47:25,556  INFO      💾  10.0 km CSV written → event_well_links_10km.csv  (109825 rows)
2025-06-04 11:47:26,114  INFO      💾  11.0 km CSV written → event_well_links_11km.csv  (129984 rows)
2025-06-04 11:47:26,733  INFO      💾  12.0 km CSV written → event_well_links_12km.csv  (149935 rows)
2025-06-04 11:47:27,419  INFO      💾  13.0 km CSV written → event_well_links_13km.csv  (170563 rows)
2025-06-04 11:47:28,930  INFO      💾  14.0 km CSV written → event_well_links_14km.csv  (191820 rows)
2025-06-04 11:47:29,759  INFO      💾  15.0 km CSV written → event_well_links_15km.csv  (214728 rows)
2025-06-04 11:47:30,653  INFO      💾  16.0 km CSV written → event_well_links_16km.csv  (237644 rows)
2025-06-04 11:47:31,651  INFO      💾  17.0 km CSV written → event_well_links_17km.csv  (262373 rows)
2025-06-04 11:47:32,702  INFO      💾  18.0 km CSV written → event_well_links_18km.csv  (289297 rows)
2025-06-04 11:47:33,839  INFO      💾  19.0 km CSV written → event_well_links_19km.csv  (315984 rows)
2025-06-04 11:47:35,076  INFO      💾  20.0 km CSV written → event_well_links_20km.csv  (341614 rows)
2025-06-04 11:47:35,076  INFO      ✅  All radii complete.

2025-06-04 11:47:35,871 - INFO - ✓ Completed merge_seismic_swd.py in 67.27 seconds

2025-06-04 11:47:35,871 - INFO - 
################################################################################
2025-06-04 11:47:35,872 - INFO - # STEP 3: SAME-DAY & N-DAY INJECTION LOOKBACK
2025-06-04 11:47:35,872 - INFO - ################################################################################

2025-06-04 11:47:35,872 - INFO - ======================================================================
2025-06-04 11:47:35,872 - INFO - Running: filter_active_wells_before_events.py
2025-06-04 11:47:35,872 - INFO - Purpose: Filter wells with injection activity before events
2025-06-04 11:47:35,872 - INFO - ======================================================================
2025-06-04 11:58:27,464 - INFO - Output:
2025-06-04 11:47:36,435  INFO      📄  Loaded swd_data_filtered.csv               → 663,917 rows × 7 cols
2025-06-04 11:47:36,555  INFO      ⚡  SWD table grouped by API (687 APIs)
2025-06-04 11:47:36,555  INFO      
────────── Processing event_well_links_1km.csv ──────────
2025-06-04 11:47:36,558  INFO      📄  Loaded event_well_links_1km.csv            →   1,177 rows × 11 cols
2025-06-04 11:47:36,609  INFO      🔗  Same-day injections matched: 878
2025-06-04 11:47:36,609  INFO      🕊️   Innocent wells found        : 299
2025-06-04 11:47:36,610  INFO      🔍  Finding most recent injection date for innocent wells...
2025-06-04 11:47:36,662  INFO      📊  Computing matched look-back metrics…
2025-06-04 11:47:36,955  INFO      📊  Computing innocent look-back metrics…
2025-06-04 11:47:37,002  INFO      ✅  Saved event_well_links_with_injection_1km.csv (878 rows)
2025-06-04 11:47:37,002  INFO      ✅  Saved innocent_wells_1km.csv             (299 rows)
2025-06-04 11:47:37,002  INFO      
────────── Processing event_well_links_2km.csv ──────────
2025-06-04 11:47:37,006  INFO      📄  Loaded event_well_links_2km.csv            →   4,775 rows × 11 cols
2025-06-04 11:47:37,064  INFO      🔗  Same-day injections matched: 3,578
2025-06-04 11:47:37,064  INFO      🕊️   Innocent wells found        : 1,200
2025-06-04 11:47:37,064  INFO      🔍  Finding most recent injection date for innocent wells...
2025-06-04 11:47:37,181  INFO      📊  Computing matched look-back metrics…
2025-06-04 11:47:38,040  INFO      📊  Computing innocent look-back metrics…
2025-06-04 11:47:38,215  INFO      ✅  Saved event_well_links_with_injection_2km.csv (3,578 rows)
2025-06-04 11:47:38,215  INFO      ✅  Saved innocent_wells_2km.csv             (1,200 rows)
2025-06-04 11:47:38,215  INFO      
────────── Processing event_well_links_3km.csv ──────────
2025-06-04 11:47:38,223  INFO      📄  Loaded event_well_links_3km.csv            →  11,645 rows × 11 cols
2025-06-04 11:47:38,280  INFO      🔗  Same-day injections matched: 8,800
2025-06-04 11:47:38,280  INFO      🕊️   Innocent wells found        : 2,849
2025-06-04 11:47:38,281  INFO      🔍  Finding most recent injection date for innocent wells...
2025-06-04 11:47:38,546  INFO      📊  Computing matched look-back metrics…
2025-06-04 11:47:40,665  INFO      📊  Computing innocent look-back metrics…
2025-06-04 11:47:41,109  INFO      ✅  Saved event_well_links_with_injection_3km.csv (8,800 rows)
2025-06-04 11:47:41,109  INFO      ✅  Saved innocent_wells_3km.csv             (2,849 rows)
2025-06-04 11:47:41,109  INFO      
────────── Processing event_well_links_4km.csv ──────────
2025-06-04 11:47:41,125  INFO      📄  Loaded event_well_links_4km.csv            →  20,274 rows × 11 cols
2025-06-04 11:47:41,189  INFO      🔗  Same-day injections matched: 15,350
2025-06-04 11:47:41,189  INFO      🕊️   Innocent wells found        : 4,942
2025-06-04 11:47:41,190  INFO      🔍  Finding most recent injection date for innocent wells...
2025-06-04 11:47:41,673  INFO      📊  Computing matched look-back metrics…
2025-06-04 11:47:45,304  INFO      📊  Computing innocent look-back metrics…
2025-06-04 11:47:46,049  INFO      ✅  Saved event_well_links_with_injection_4km.csv (15,350 rows)
2025-06-04 11:47:46,049  INFO      ✅  Saved innocent_wells_4km.csv             (4,942 rows)
2025-06-04 11:47:46,049  INFO      
────────── Processing event_well_links_5km.csv ──────────
2025-06-04 11:47:46,068  INFO      📄  Loaded event_well_links_5km.csv            →  30,417 rows × 11 cols
2025-06-04 11:47:46,138  INFO      🔗  Same-day injections matched: 22,671
2025-06-04 11:47:46,138  INFO      🕊️   Innocent wells found        : 7,789
2025-06-04 11:47:46,139  INFO      🔍  Finding most recent injection date for innocent wells...
2025-06-04 11:47:46,881  INFO      📊  Computing matched look-back metrics…
2025-06-04 11:47:52,193  INFO      📊  Computing innocent look-back metrics…
2025-06-04 11:47:53,331  INFO      ✅  Saved event_well_links_with_injection_5km.csv (22,671 rows)
2025-06-04 11:47:53,331  INFO      ✅  Saved innocent_wells_5km.csv             (7,789 rows)
2025-06-04 11:47:53,331  INFO      
────────── Processing event_well_links_6km.csv ──────────
2025-06-04 11:47:53,355  INFO      📄  Loaded event_well_links_6km.csv            →  42,127 rows × 11 cols
2025-06-04 11:47:53,430  INFO      🔗  Same-day injections matched: 30,993
2025-06-04 11:47:53,430  INFO      🕊️   Innocent wells found        : 11,192
2025-06-04 11:47:53,431  INFO      🔍  Finding most recent injection date for innocent wells...
2025-06-04 11:47:54,486  INFO      📊  Computing matched look-back metrics…
2025-06-04 11:48:01,786  INFO      📊  Computing innocent look-back metrics…
2025-06-04 11:48:03,459  INFO      ✅  Saved event_well_links_with_injection_6km.csv (30,993 rows)
2025-06-04 11:48:03,459  INFO      ✅  Saved innocent_wells_6km.csv             (11,192 rows)
2025-06-04 11:48:03,459  INFO      
────────── Processing event_well_links_7km.csv ──────────
2025-06-04 11:48:03,495  INFO      📄  Loaded event_well_links_7km.csv            →  55,872 rows × 11 cols
2025-06-04 11:48:03,580  INFO      🔗  Same-day injections matched: 40,803
2025-06-04 11:48:03,580  INFO      🕊️   Innocent wells found        : 15,152
2025-06-04 11:48:03,581  INFO      🔍  Finding most recent injection date for innocent wells...
2025-06-04 11:48:05,006  INFO      📊  Computing matched look-back metrics…
2025-06-04 11:48:14,614  INFO      📊  Computing innocent look-back metrics…
2025-06-04 11:48:16,851  INFO      ✅  Saved event_well_links_with_injection_7km.csv (40,803 rows)
2025-06-04 11:48:16,851  INFO      ✅  Saved innocent_wells_7km.csv             (15,152 rows)
2025-06-04 11:48:16,851  INFO      
────────── Processing event_well_links_8km.csv ──────────
2025-06-04 11:48:16,892  INFO      📄  Loaded event_well_links_8km.csv            →  71,996 rows × 11 cols
2025-06-04 11:48:16,985  INFO      🔗  Same-day injections matched: 51,932
2025-06-04 11:48:16,985  INFO      🕊️   Innocent wells found        : 20,184
2025-06-04 11:48:16,986  INFO      🔍  Finding most recent injection date for innocent wells...
2025-06-04 11:48:18,898  INFO      📊  Computing matched look-back metrics…
2025-06-04 11:48:30,985  INFO      📊  Computing innocent look-back metrics…
2025-06-04 11:48:33,963  INFO      ✅  Saved event_well_links_with_injection_8km.csv (51,932 rows)
2025-06-04 11:48:33,963  INFO      ✅  Saved innocent_wells_8km.csv             (20,184 rows)
2025-06-04 11:48:33,963  INFO      
────────── Processing event_well_links_9km.csv ──────────
2025-06-04 11:48:34,014  INFO      📄  Loaded event_well_links_9km.csv            →  90,575 rows × 11 cols
2025-06-04 11:48:34,120  INFO      🔗  Same-day injections matched: 64,431
2025-06-04 11:48:34,121  INFO      🕊️   Innocent wells found        : 26,297
2025-06-04 11:48:34,122  INFO      🔍  Finding most recent injection date for innocent wells...
2025-06-04 11:48:36,644  INFO      📊  Computing matched look-back metrics…
2025-06-04 11:48:51,515  INFO      📊  Computing innocent look-back metrics…
2025-06-04 11:48:55,354  INFO      ✅  Saved event_well_links_with_injection_9km.csv (64,431 rows)
2025-06-04 11:48:55,354  INFO      ✅  Saved innocent_wells_9km.csv             (26,297 rows)
2025-06-04 11:48:55,354  INFO      
────────── Processing event_well_links_10km.csv ──────────
2025-06-04 11:48:55,412  INFO      📄  Loaded event_well_links_10km.csv           → 109,825 rows × 11 cols
2025-06-04 11:48:55,523  INFO      🔗  Same-day injections matched: 76,806
2025-06-04 11:48:55,523  INFO      🕊️   Innocent wells found        : 33,208
2025-06-04 11:48:55,525  INFO      🔍  Finding most recent injection date for innocent wells...
2025-06-04 11:48:58,735  INFO      📊  Computing matched look-back metrics…
2025-06-04 11:49:16,279  INFO      📊  Computing innocent look-back metrics…
2025-06-04 11:49:21,110  INFO      ✅  Saved event_well_links_with_injection_10km.csv (76,806 rows)
2025-06-04 11:49:21,110  INFO      ✅  Saved innocent_wells_10km.csv            (33,208 rows)
2025-06-04 11:49:21,110  INFO      
────────── Processing event_well_links_11km.csv ──────────
2025-06-04 11:49:21,180  INFO      📄  Loaded event_well_links_11km.csv           → 129,984 rows × 11 cols
2025-06-04 11:49:21,309  INFO      🔗  Same-day injections matched: 89,264
2025-06-04 11:49:21,309  INFO      🕊️   Innocent wells found        : 40,951
2025-06-04 11:49:21,311  INFO      🔍  Finding most recent injection date for innocent wells...
2025-06-04 11:49:25,190  INFO      📊  Computing matched look-back metrics…
2025-06-04 11:49:45,620  INFO      📊  Computing innocent look-back metrics…
2025-06-04 11:49:51,557  INFO      ✅  Saved event_well_links_with_injection_11km.csv (89,264 rows)
2025-06-04 11:49:51,557  INFO      ✅  Saved innocent_wells_11km.csv            (40,951 rows)
2025-06-04 11:49:51,557  INFO      
────────── Processing event_well_links_12km.csv ──────────
2025-06-04 11:49:51,644  INFO      📄  Loaded event_well_links_12km.csv           → 149,935 rows × 11 cols
2025-06-04 11:49:51,789  INFO      🔗  Same-day injections matched: 101,818
2025-06-04 11:49:51,789  INFO      🕊️   Innocent wells found        : 48,385
2025-06-04 11:49:51,791  INFO      🔍  Finding most recent injection date for innocent wells...
2025-06-04 11:49:56,403  INFO      📊  Computing matched look-back metrics…
2025-06-04 11:50:20,371  INFO      📊  Computing innocent look-back metrics…
2025-06-04 11:50:27,659  INFO      ✅  Saved event_well_links_with_injection_12km.csv (101,818 rows)
2025-06-04 11:50:27,659  INFO      ✅  Saved innocent_wells_12km.csv            (48,385 rows)
2025-06-04 11:50:27,659  INFO      
────────── Processing event_well_links_13km.csv ──────────
2025-06-04 11:50:27,758  INFO      📄  Loaded event_well_links_13km.csv           → 170,563 rows × 11 cols
2025-06-04 11:50:27,931  INFO      🔗  Same-day injections matched: 114,685
2025-06-04 11:50:27,931  INFO      🕊️   Innocent wells found        : 56,208
2025-06-04 11:50:27,933  INFO      🔍  Finding most recent injection date for innocent wells...
2025-06-04 11:50:33,624  INFO      📊  Computing matched look-back metrics…
2025-06-04 11:51:00,239  INFO      📊  Computing innocent look-back metrics…
2025-06-04 11:51:08,322  INFO      ✅  Saved event_well_links_with_injection_13km.csv (114,685 rows)
2025-06-04 11:51:08,323  INFO      ✅  Saved innocent_wells_13km.csv            (56,208 rows)
2025-06-04 11:51:08,323  INFO      
────────── Processing event_well_links_14km.csv ──────────
2025-06-04 11:51:08,426  INFO      📄  Loaded event_well_links_14km.csv           → 191,820 rows × 11 cols
2025-06-04 11:51:08,591  INFO      🔗  Same-day injections matched: 128,046
2025-06-04 11:51:08,591  INFO      🕊️   Innocent wells found        : 64,203
2025-06-04 11:51:08,594  INFO      🔍  Finding most recent injection date for innocent wells...
2025-06-04 11:51:14,765  INFO      📊  Computing matched look-back metrics…
2025-06-04 11:51:44,004  INFO      📊  Computing innocent look-back metrics…
2025-06-04 11:51:53,239  INFO      ✅  Saved event_well_links_with_injection_14km.csv (128,046 rows)
2025-06-04 11:51:53,239  INFO      ✅  Saved innocent_wells_14km.csv            (64,203 rows)
2025-06-04 11:51:53,239  INFO      
────────── Processing event_well_links_15km.csv ──────────
2025-06-04 11:51:53,359  INFO      📄  Loaded event_well_links_15km.csv           → 214,728 rows × 11 cols
2025-06-04 11:51:53,541  INFO      🔗  Same-day injections matched: 142,760
2025-06-04 11:51:53,541  INFO      🕊️   Innocent wells found        : 72,498
2025-06-04 11:51:53,543  INFO      🔍  Finding most recent injection date for innocent wells...
2025-06-04 11:52:00,432  INFO      📊  Computing matched look-back metrics…
2025-06-04 11:52:33,570  INFO      📊  Computing innocent look-back metrics…
2025-06-04 11:52:44,002  INFO      ✅  Saved event_well_links_with_injection_15km.csv (142,760 rows)
2025-06-04 11:52:44,002  INFO      ✅  Saved innocent_wells_15km.csv            (72,498 rows)
2025-06-04 11:52:44,002  INFO      
────────── Processing event_well_links_16km.csv ──────────
2025-06-04 11:52:44,141  INFO      📄  Loaded event_well_links_16km.csv           → 237,644 rows × 11 cols
2025-06-04 11:52:44,367  INFO      🔗  Same-day injections matched: 157,471
2025-06-04 11:52:44,367  INFO      🕊️   Innocent wells found        : 80,809
2025-06-04 11:52:44,369  INFO      🔍  Finding most recent injection date for innocent wells...
2025-06-04 11:52:52,478  INFO      📊  Computing matched look-back metrics…
2025-06-04 11:53:29,779  INFO      📊  Computing innocent look-back metrics…
2025-06-04 11:53:41,808  INFO      ✅  Saved event_well_links_with_injection_16km.csv (157,471 rows)
2025-06-04 11:53:41,808  INFO      ✅  Saved innocent_wells_16km.csv            (80,809 rows)
2025-06-04 11:53:41,808  INFO      
────────── Processing event_well_links_17km.csv ──────────
2025-06-04 11:53:41,958  INFO      📄  Loaded event_well_links_17km.csv           → 262,373 rows × 11 cols
2025-06-04 11:53:42,177  INFO      🔗  Same-day injections matched: 172,552
2025-06-04 11:53:42,177  INFO      🕊️   Innocent wells found        : 90,526
2025-06-04 11:53:42,180  INFO      🔍  Finding most recent injection date for innocent wells...
2025-06-04 11:53:51,053  INFO      📊  Computing matched look-back metrics…
2025-06-04 11:54:31,089  INFO      📊  Computing innocent look-back metrics…
2025-06-04 11:54:44,206  INFO      ✅  Saved event_well_links_with_injection_17km.csv (172,552 rows)
2025-06-04 11:54:44,206  INFO      ✅  Saved innocent_wells_17km.csv            (90,526 rows)
2025-06-04 11:54:44,206  INFO      
────────── Processing event_well_links_18km.csv ──────────
2025-06-04 11:54:44,365  INFO      📄  Loaded event_well_links_18km.csv           → 289,297 rows × 11 cols
2025-06-04 11:54:44,608  INFO      🔗  Same-day injections matched: 189,120
2025-06-04 11:54:44,608  INFO      🕊️   Innocent wells found        : 100,916
2025-06-04 11:54:44,611  INFO      🔍  Finding most recent injection date for innocent wells...
2025-06-04 11:54:54,327  INFO      📊  Computing matched look-back metrics…
2025-06-04 11:55:37,905  INFO      📊  Computing innocent look-back metrics…
2025-06-04 11:55:52,449  INFO      ✅  Saved event_well_links_with_injection_18km.csv (189,120 rows)
2025-06-04 11:55:52,449  INFO      ✅  Saved innocent_wells_18km.csv            (100,916 rows)
2025-06-04 11:55:52,450  INFO      
────────── Processing event_well_links_19km.csv ──────────
2025-06-04 11:55:52,634  INFO      📄  Loaded event_well_links_19km.csv           → 315,984 rows × 11 cols
2025-06-04 11:55:52,890  INFO      🔗  Same-day injections matched: 205,221
2025-06-04 11:55:52,890  INFO      🕊️   Innocent wells found        : 111,557
2025-06-04 11:55:52,893  INFO      🔍  Finding most recent injection date for innocent wells...
2025-06-04 11:56:03,690  INFO      📊  Computing matched look-back metrics…
2025-06-04 11:56:50,513  INFO      📊  Computing innocent look-back metrics…
2025-06-04 11:57:06,678  INFO      ✅  Saved event_well_links_with_injection_19km.csv (205,221 rows)
2025-06-04 11:57:06,679  INFO      ✅  Saved innocent_wells_19km.csv            (111,557 rows)
2025-06-04 11:57:06,679  INFO      
────────── Processing event_well_links_20km.csv ──────────
2025-06-04 11:57:06,867  INFO      📄  Loaded event_well_links_20km.csv           → 341,614 rows × 11 cols
2025-06-04 11:57:07,139  INFO      🔗  Same-day injections matched: 220,739
2025-06-04 11:57:07,139  INFO      🕊️   Innocent wells found        : 121,724
2025-06-04 11:57:07,142  INFO      🔍  Finding most recent injection date for innocent wells...
2025-06-04 11:57:18,631  INFO      📊  Computing matched look-back metrics…
2025-06-04 11:58:09,782  INFO      📊  Computing innocent look-back metrics…
2025-06-04 11:58:27,343  INFO      ✅  Saved event_well_links_with_injection_20km.csv (220,739 rows)
2025-06-04 11:58:27,343  INFO      ✅  Saved innocent_wells_20km.csv            (121,724 rows)
2025-06-04 11:58:27,343  INFO      
🎉  All linkage files processed.

2025-06-04 11:58:27,464 - INFO - ✓ Completed filter_active_wells_before_events.py in 651.59 seconds

2025-06-04 11:58:27,464 - INFO - ======================================================================
2025-06-04 11:58:27,464 - INFO - Running: filter_merge_events_and_nonevents.py
2025-06-04 11:58:27,464 - INFO - Purpose: Merge active wells with innocent wells (non-injecting)
2025-06-04 11:58:27,464 - INFO - ======================================================================
2025-06-04 11:58:40,320 - INFO - Output:

─── Processing 1 km files ─────────────────────────────────────
✅  innocent_wells_with_fakeids_1km.csv       (299 rows)
✅  combined_event_well_links_1km.csv         (1,177 rows)

─── Processing 2 km files ─────────────────────────────────────
✅  innocent_wells_with_fakeids_2km.csv       (1,200 rows)
✅  combined_event_well_links_2km.csv         (4,778 rows)

─── Processing 3 km files ─────────────────────────────────────
✅  innocent_wells_with_fakeids_3km.csv       (2,849 rows)
✅  combined_event_well_links_3km.csv         (11,649 rows)

─── Processing 4 km files ─────────────────────────────────────
✅  innocent_wells_with_fakeids_4km.csv       (4,942 rows)
✅  combined_event_well_links_4km.csv         (20,292 rows)

─── Processing 5 km files ─────────────────────────────────────
✅  innocent_wells_with_fakeids_5km.csv       (7,789 rows)
✅  combined_event_well_links_5km.csv         (30,460 rows)

─── Processing 6 km files ─────────────────────────────────────
✅  innocent_wells_with_fakeids_6km.csv       (11,192 rows)
✅  combined_event_well_links_6km.csv         (42,185 rows)

─── Processing 7 km files ─────────────────────────────────────
✅  innocent_wells_with_fakeids_7km.csv       (15,152 rows)
✅  combined_event_well_links_7km.csv         (55,955 rows)

─── Processing 8 km files ─────────────────────────────────────
✅  innocent_wells_with_fakeids_8km.csv       (20,184 rows)
✅  combined_event_well_links_8km.csv         (72,116 rows)

─── Processing 9 km files ─────────────────────────────────────
✅  innocent_wells_with_fakeids_9km.csv       (26,297 rows)
✅  combined_event_well_links_9km.csv         (90,728 rows)

─── Processing 10 km files ─────────────────────────────────────
✅  innocent_wells_with_fakeids_10km.csv      (33,208 rows)
✅  combined_event_well_links_10km.csv        (110,014 rows)

─── Processing 11 km files ─────────────────────────────────────
✅  innocent_wells_with_fakeids_11km.csv      (40,951 rows)
✅  combined_event_well_links_11km.csv        (130,215 rows)

─── Processing 12 km files ─────────────────────────────────────
✅  innocent_wells_with_fakeids_12km.csv      (48,385 rows)
✅  combined_event_well_links_12km.csv        (150,203 rows)

─── Processing 13 km files ─────────────────────────────────────
✅  innocent_wells_with_fakeids_13km.csv      (56,208 rows)
✅  combined_event_well_links_13km.csv        (170,893 rows)

─── Processing 14 km files ─────────────────────────────────────
✅  innocent_wells_with_fakeids_14km.csv      (64,203 rows)
✅  combined_event_well_links_14km.csv        (192,249 rows)

─── Processing 15 km files ─────────────────────────────────────
✅  innocent_wells_with_fakeids_15km.csv      (72,498 rows)
✅  combined_event_well_links_15km.csv        (215,258 rows)

─── Processing 16 km files ─────────────────────────────────────
✅  innocent_wells_with_fakeids_16km.csv      (80,809 rows)
✅  combined_event_well_links_16km.csv        (238,280 rows)

─── Processing 17 km files ─────────────────────────────────────
✅  innocent_wells_with_fakeids_17km.csv      (90,526 rows)
✅  combined_event_well_links_17km.csv        (263,078 rows)

─── Processing 18 km files ─────────────────────────────────────
✅  innocent_wells_with_fakeids_18km.csv      (100,916 rows)
✅  combined_event_well_links_18km.csv        (290,036 rows)

─── Processing 19 km files ─────────────────────────────────────
✅  innocent_wells_with_fakeids_19km.csv      (111,557 rows)
✅  combined_event_well_links_19km.csv        (316,778 rows)

─── Processing 20 km files ─────────────────────────────────────
✅  innocent_wells_with_fakeids_20km.csv      (121,724 rows)
✅  combined_event_well_links_20km.csv        (342,463 rows)

2025-06-04 11:58:40,321 - INFO - ✓ Completed filter_merge_events_and_nonevents.py in 12.86 seconds

2025-06-04 11:58:40,321 - INFO - 
################################################################################
2025-06-04 11:58:40,321 - INFO - # STEP 4: FAULT-PROXIMITY FEATURES
2025-06-04 11:58:40,321 - INFO - ################################################################################

2025-06-04 11:58:40,321 - INFO - ======================================================================
2025-06-04 11:58:40,321 - INFO - Running: add_geoscience_to_event_well_links_with_injection.py
2025-06-04 11:58:40,321 - INFO - Purpose: Add nearest fault distance and fault segment counts
2025-06-04 11:58:40,321 - INFO - ======================================================================
2025-06-04 12:06:11,175 - INFO - Output:
2025-06-04 11:58:40,797 | INFO    | 
══════════════════════════════════════════════════════════════════════════════
BATCH FAULT-PROXIMITY AUGMENTATION starting …
2025-06-04 11:58:40,797 | INFO    | Processing 20 input files
2025-06-04 11:58:40,797 | INFO    | 
Processing file 1 of 20: combined_event_well_links_1km.csv
2025-06-04 11:58:40,797 | INFO    | 
══════════════════════════════════════════════════════════════════════════════
PROCESSING combined_event_well_links_1km.csv (radius: 1 km)
2025-06-04 11:58:40,797 | INFO    | ⏳  Loading linkage CSV (combined_event_well_links_1km.csv) …
2025-06-04 11:58:40,799 | INFO    | ✅  Loading linkage CSV (combined_event_well_links_1km.csv) – done in 0.0s
2025-06-04 11:58:40,799 | INFO    | Rows in linkage CSV : 1,177
2025-06-04 11:58:40,800 | INFO    | Magnitude stats for ALL rows: mean=1.283, non-zero=878/1177 (74.6%)
2025-06-04 11:58:40,800 | INFO    | Magnitude stats for rows with GOOD coordinates: mean=1.283, non-zero=878/1177 (74.6%)
2025-06-04 11:58:40,818 | INFO    | ⏳  Loading fault shapefile …
2025-06-04 11:58:40,931 | INFO    | ✅  Loading fault shapefile – done in 0.1s
2025-06-04 11:58:40,932 | WARNING | Faults don't overlap wells in declared CRS – trying candidates …
2025-06-04 11:58:40,950 | INFO    | 🌎  Using NAD83 / UTM 13N (EPSG:26913) for faults (bbox now overlaps)
2025-06-04 11:58:40,950 | INFO    | Fault polylines after CRS fix : 5,513
2025-06-04 11:58:40,957 | INFO    | ⏳  Splitting faults into 1-km segments …
2025-06-04 11:58:41,437 | INFO    | ✅  Splitting faults into 1-km segments – done in 0.5s
2025-06-04 11:58:41,437 | INFO    | Total 1-km segments : 10,448
2025-06-04 11:58:41,437 | INFO    | ⏳  Nearest-fault search …
2025-06-04 11:58:41,445 | INFO    | ✅  Nearest-fault search – done in 0.0s
2025-06-04 11:58:41,449 | INFO    | ⏳  Counting segments ≤1 km …
2025-06-04 11:58:41,465 | INFO    | ✅  Counting segments ≤1 km – done in 0.0s
2025-06-04 11:58:41,465 | INFO    | All wells matched to ≥1 fault ✔️
2025-06-04 11:58:41,580 | INFO    | Saved augmented CSV with ALL rows → event_well_links_with_faults_1km.csv
2025-06-04 11:58:41,580 | INFO    | ⏳  Writing full wells_vs_faults map for 1km …
2025-06-04 11:58:41,933 | INFO    | ✅  Writing full wells_vs_faults map for 1km – done in 0.4s
2025-06-04 11:58:41,933 | INFO    | Wrote full map → wells_vs_faults_1km.png
2025-06-04 11:58:41,933 | INFO    | 🎉  Finished processing combined_event_well_links_1km.csv – runtime 1.1s
2025-06-04 11:58:41,934 | INFO    | 
Processing file 2 of 20: combined_event_well_links_2km.csv
2025-06-04 11:58:41,934 | INFO    | 
══════════════════════════════════════════════════════════════════════════════
PROCESSING combined_event_well_links_2km.csv (radius: 2 km)
2025-06-04 11:58:41,934 | INFO    | ⏳  Loading linkage CSV (combined_event_well_links_2km.csv) …
2025-06-04 11:58:41,939 | INFO    | ✅  Loading linkage CSV (combined_event_well_links_2km.csv) – done in 0.0s
2025-06-04 11:58:41,939 | INFO    | Rows in linkage CSV : 4,778
2025-06-04 11:58:41,940 | INFO    | Magnitude stats for ALL rows: mean=1.302, non-zero=3578/4778 (74.9%)
2025-06-04 11:58:41,940 | INFO    | Magnitude stats for rows with GOOD coordinates: mean=1.302, non-zero=3578/4778 (74.9%)
2025-06-04 11:58:41,947 | INFO    | ⏳  Nearest-fault search …
2025-06-04 11:58:41,962 | INFO    | ✅  Nearest-fault search – done in 0.0s
2025-06-04 11:58:41,962 | INFO    | ⏳  Counting segments ≤2 km …
2025-06-04 11:58:41,997 | INFO    | ✅  Counting segments ≤2 km – done in 0.0s
2025-06-04 11:58:41,997 | INFO    | All wells matched to ≥1 fault ✔️
2025-06-04 11:58:42,456 | INFO    | Saved augmented CSV with ALL rows → event_well_links_with_faults_2km.csv
2025-06-04 11:58:42,456 | INFO    | 🎉  Finished processing combined_event_well_links_2km.csv – runtime 0.5s
2025-06-04 11:58:42,458 | INFO    | 
Processing file 3 of 20: combined_event_well_links_3km.csv
2025-06-04 11:58:42,458 | INFO    | 
══════════════════════════════════════════════════════════════════════════════
PROCESSING combined_event_well_links_3km.csv (radius: 3 km)
2025-06-04 11:58:42,458 | INFO    | ⏳  Loading linkage CSV (combined_event_well_links_3km.csv) …
2025-06-04 11:58:42,469 | INFO    | ✅  Loading linkage CSV (combined_event_well_links_3km.csv) – done in 0.0s
2025-06-04 11:58:42,469 | INFO    | Rows in linkage CSV : 11,649
2025-06-04 11:58:42,470 | INFO    | Magnitude stats for ALL rows: mean=1.313, non-zero=8800/11649 (75.5%)
2025-06-04 11:58:42,470 | INFO    | Magnitude stats for rows with GOOD coordinates: mean=1.313, non-zero=8800/11649 (75.5%)
2025-06-04 11:58:42,497 | INFO    | ⏳  Nearest-fault search …
2025-06-04 11:58:42,529 | INFO    | ✅  Nearest-fault search – done in 0.0s
2025-06-04 11:58:42,530 | INFO    | ⏳  Counting segments ≤3 km …
2025-06-04 11:58:42,629 | INFO    | ✅  Counting segments ≤3 km – done in 0.1s
2025-06-04 11:58:42,629 | INFO    | All wells matched to ≥1 fault ✔️
2025-06-04 11:58:43,735 | INFO    | Saved augmented CSV with ALL rows → event_well_links_with_faults_3km.csv
2025-06-04 11:58:43,735 | INFO    | 🎉  Finished processing combined_event_well_links_3km.csv – runtime 1.3s
2025-06-04 11:58:43,738 | INFO    | 
Processing file 4 of 20: combined_event_well_links_4km.csv
2025-06-04 11:58:43,738 | INFO    | 
══════════════════════════════════════════════════════════════════════════════
PROCESSING combined_event_well_links_4km.csv (radius: 4 km)
2025-06-04 11:58:43,738 | INFO    | ⏳  Loading linkage CSV (combined_event_well_links_4km.csv) …
2025-06-04 11:58:43,755 | INFO    | ✅  Loading linkage CSV (combined_event_well_links_4km.csv) – done in 0.0s
2025-06-04 11:58:43,755 | INFO    | Rows in linkage CSV : 20,292
2025-06-04 11:58:43,756 | INFO    | Magnitude stats for ALL rows: mean=1.296, non-zero=15350/20292 (75.6%)
2025-06-04 11:58:43,756 | INFO    | Magnitude stats for rows with GOOD coordinates: mean=1.296, non-zero=15350/20292 (75.6%)
2025-06-04 11:58:43,772 | INFO    | ⏳  Nearest-fault search …
2025-06-04 11:58:43,827 | INFO    | ✅  Nearest-fault search – done in 0.1s
2025-06-04 11:58:43,828 | INFO    | ⏳  Counting segments ≤4 km …
2025-06-04 11:58:44,055 | INFO    | ✅  Counting segments ≤4 km – done in 0.2s
2025-06-04 11:58:44,055 | INFO    | All wells matched to ≥1 fault ✔️
2025-06-04 11:58:45,992 | INFO    | Saved augmented CSV with ALL rows → event_well_links_with_faults_4km.csv
2025-06-04 11:58:45,992 | INFO    | 🎉  Finished processing combined_event_well_links_4km.csv – runtime 2.3s
2025-06-04 11:58:45,998 | INFO    | 
Processing file 5 of 20: combined_event_well_links_5km.csv
2025-06-04 11:58:45,998 | INFO    | 
══════════════════════════════════════════════════════════════════════════════
PROCESSING combined_event_well_links_5km.csv (radius: 5 km)
2025-06-04 11:58:45,998 | INFO    | ⏳  Loading linkage CSV (combined_event_well_links_5km.csv) …
2025-06-04 11:58:46,023 | INFO    | ✅  Loading linkage CSV (combined_event_well_links_5km.csv) – done in 0.0s
2025-06-04 11:58:46,023 | INFO    | Rows in linkage CSV : 30,460
2025-06-04 11:58:46,024 | INFO    | Magnitude stats for ALL rows: mean=1.267, non-zero=22671/30460 (74.4%)
2025-06-04 11:58:46,024 | INFO    | Magnitude stats for rows with GOOD coordinates: mean=1.267, non-zero=22671/30460 (74.4%)
2025-06-04 11:58:46,046 | INFO    | ⏳  Nearest-fault search …
2025-06-04 11:58:46,128 | INFO    | ✅  Nearest-fault search – done in 0.1s
2025-06-04 11:58:46,130 | INFO    | ⏳  Counting segments ≤5 km …
2025-06-04 11:58:46,550 | INFO    | ✅  Counting segments ≤5 km – done in 0.4s
2025-06-04 11:58:46,550 | INFO    | All wells matched to ≥1 fault ✔️
2025-06-04 11:58:49,435 | INFO    | Saved augmented CSV with ALL rows → event_well_links_with_faults_5km.csv
2025-06-04 11:58:49,435 | INFO    | 🎉  Finished processing combined_event_well_links_5km.csv – runtime 3.4s
2025-06-04 11:58:49,442 | INFO    | 
Processing file 6 of 20: combined_event_well_links_6km.csv
2025-06-04 11:58:49,442 | INFO    | 
══════════════════════════════════════════════════════════════════════════════
PROCESSING combined_event_well_links_6km.csv (radius: 6 km)
2025-06-04 11:58:49,442 | INFO    | ⏳  Loading linkage CSV (combined_event_well_links_6km.csv) …
2025-06-04 11:58:49,477 | INFO    | ✅  Loading linkage CSV (combined_event_well_links_6km.csv) – done in 0.0s
2025-06-04 11:58:49,477 | INFO    | Rows in linkage CSV : 42,185
2025-06-04 11:58:49,478 | INFO    | Magnitude stats for ALL rows: mean=1.243, non-zero=30993/42185 (73.5%)
2025-06-04 11:58:49,478 | INFO    | Magnitude stats for rows with GOOD coordinates: mean=1.243, non-zero=30993/42185 (73.5%)
2025-06-04 11:58:49,520 | INFO    | ⏳  Nearest-fault search …
2025-06-04 11:58:49,633 | INFO    | ✅  Nearest-fault search – done in 0.1s
2025-06-04 11:58:49,634 | INFO    | ⏳  Counting segments ≤6 km …
2025-06-04 11:58:50,316 | INFO    | ✅  Counting segments ≤6 km – done in 0.7s
2025-06-04 11:58:50,316 | INFO    | All wells matched to ≥1 fault ✔️
2025-06-04 11:58:54,311 | INFO    | Saved augmented CSV with ALL rows → event_well_links_with_faults_6km.csv
2025-06-04 11:58:54,311 | INFO    | 🎉  Finished processing combined_event_well_links_6km.csv – runtime 4.9s
2025-06-04 11:58:54,321 | INFO    | 
Processing file 7 of 20: combined_event_well_links_7km.csv
2025-06-04 11:58:54,321 | INFO    | 
══════════════════════════════════════════════════════════════════════════════
PROCESSING combined_event_well_links_7km.csv (radius: 7 km)
2025-06-04 11:58:54,321 | INFO    | ⏳  Loading linkage CSV (combined_event_well_links_7km.csv) …
2025-06-04 11:58:54,365 | INFO    | ✅  Loading linkage CSV (combined_event_well_links_7km.csv) – done in 0.0s
2025-06-04 11:58:54,365 | INFO    | Rows in linkage CSV : 55,955
2025-06-04 11:58:54,366 | INFO    | Magnitude stats for ALL rows: mean=1.233, non-zero=40803/55955 (72.9%)
2025-06-04 11:58:54,366 | INFO    | Magnitude stats for rows with GOOD coordinates: mean=1.233, non-zero=40803/55955 (72.9%)
2025-06-04 11:58:54,416 | INFO    | ⏳  Nearest-fault search …
2025-06-04 11:58:54,562 | INFO    | ✅  Nearest-fault search – done in 0.1s
2025-06-04 11:58:54,564 | INFO    | ⏳  Counting segments ≤7 km …
2025-06-04 11:58:55,657 | INFO    | ✅  Counting segments ≤7 km – done in 1.1s
2025-06-04 11:58:55,657 | INFO    | All wells matched to ≥1 fault ✔️
2025-06-04 11:59:00,960 | INFO    | Saved augmented CSV with ALL rows → event_well_links_with_faults_7km.csv
2025-06-04 11:59:00,960 | INFO    | 🎉  Finished processing combined_event_well_links_7km.csv – runtime 6.6s
2025-06-04 11:59:00,975 | INFO    | 
Processing file 8 of 20: combined_event_well_links_8km.csv
2025-06-04 11:59:00,975 | INFO    | 
══════════════════════════════════════════════════════════════════════════════
PROCESSING combined_event_well_links_8km.csv (radius: 8 km)
2025-06-04 11:59:00,975 | INFO    | ⏳  Loading linkage CSV (combined_event_well_links_8km.csv) …
2025-06-04 11:59:01,029 | INFO    | ✅  Loading linkage CSV (combined_event_well_links_8km.csv) – done in 0.1s
2025-06-04 11:59:01,029 | INFO    | Rows in linkage CSV : 72,116
2025-06-04 11:59:01,030 | INFO    | Magnitude stats for ALL rows: mean=1.216, non-zero=51932/72116 (72.0%)
2025-06-04 11:59:01,030 | INFO    | Magnitude stats for rows with GOOD coordinates: mean=1.216, non-zero=51932/72116 (72.0%)
2025-06-04 11:59:01,104 | INFO    | ⏳  Nearest-fault search …
2025-06-04 11:59:01,292 | INFO    | ✅  Nearest-fault search – done in 0.2s
2025-06-04 11:59:01,294 | INFO    | ⏳  Counting segments ≤8 km …
2025-06-04 11:59:02,945 | INFO    | ✅  Counting segments ≤8 km – done in 1.7s
2025-06-04 11:59:02,945 | INFO    | All wells matched to ≥1 fault ✔️
2025-06-04 11:59:09,745 | INFO    | Saved augmented CSV with ALL rows → event_well_links_with_faults_8km.csv
2025-06-04 11:59:09,745 | INFO    | 🎉  Finished processing combined_event_well_links_8km.csv – runtime 8.8s
2025-06-04 11:59:09,763 | INFO    | 
Processing file 9 of 20: combined_event_well_links_9km.csv
2025-06-04 11:59:09,763 | INFO    | 
══════════════════════════════════════════════════════════════════════════════
PROCESSING combined_event_well_links_9km.csv (radius: 9 km)
2025-06-04 11:59:09,763 | INFO    | ⏳  Loading linkage CSV (combined_event_well_links_9km.csv) …
2025-06-04 11:59:09,829 | INFO    | ✅  Loading linkage CSV (combined_event_well_links_9km.csv) – done in 0.1s
2025-06-04 11:59:09,830 | INFO    | Rows in linkage CSV : 90,728
2025-06-04 11:59:09,831 | INFO    | Magnitude stats for ALL rows: mean=1.199, non-zero=64431/90728 (71.0%)
2025-06-04 11:59:09,831 | INFO    | Magnitude stats for rows with GOOD coordinates: mean=1.199, non-zero=64431/90728 (71.0%)
2025-06-04 11:59:09,915 | INFO    | ⏳  Nearest-fault search …
2025-06-04 11:59:10,149 | INFO    | ✅  Nearest-fault search – done in 0.2s
2025-06-04 11:59:10,152 | INFO    | ⏳  Counting segments ≤9 km …
2025-06-04 11:59:12,580 | INFO    | ✅  Counting segments ≤9 km – done in 2.4s
2025-06-04 11:59:12,580 | INFO    | All wells matched to ≥1 fault ✔️
2025-06-04 11:59:21,229 | INFO    | Saved augmented CSV with ALL rows → event_well_links_with_faults_9km.csv
2025-06-04 11:59:21,229 | INFO    | 🎉  Finished processing combined_event_well_links_9km.csv – runtime 11.5s
2025-06-04 11:59:21,251 | INFO    | 
Processing file 10 of 20: combined_event_well_links_10km.csv
2025-06-04 11:59:21,251 | INFO    | 
══════════════════════════════════════════════════════════════════════════════
PROCESSING combined_event_well_links_10km.csv (radius: 10 km)
2025-06-04 11:59:21,251 | INFO    | ⏳  Loading linkage CSV (combined_event_well_links_10km.csv) …
2025-06-04 11:59:21,336 | INFO    | ✅  Loading linkage CSV (combined_event_well_links_10km.csv) – done in 0.1s
2025-06-04 11:59:21,336 | INFO    | Rows in linkage CSV : 110,014
2025-06-04 11:59:21,337 | INFO    | Magnitude stats for ALL rows: mean=1.174, non-zero=76806/110014 (69.8%)
2025-06-04 11:59:21,337 | INFO    | Magnitude stats for rows with GOOD coordinates: mean=1.174, non-zero=76806/110014 (69.8%)
2025-06-04 11:59:21,446 | INFO    | ⏳  Nearest-fault search …
2025-06-04 11:59:21,734 | INFO    | ✅  Nearest-fault search – done in 0.3s
2025-06-04 11:59:21,738 | INFO    | ⏳  Counting segments ≤10 km …
2025-06-04 11:59:25,315 | INFO    | ✅  Counting segments ≤10 km – done in 3.6s
2025-06-04 11:59:25,315 | INFO    | All wells matched to ≥1 fault ✔️
2025-06-04 11:59:35,845 | INFO    | Saved augmented CSV with ALL rows → event_well_links_with_faults_10km.csv
2025-06-04 11:59:35,845 | INFO    | 🎉  Finished processing combined_event_well_links_10km.csv – runtime 14.6s
2025-06-04 11:59:35,872 | INFO    | 
Processing file 11 of 20: combined_event_well_links_11km.csv
2025-06-04 11:59:35,872 | INFO    | 
══════════════════════════════════════════════════════════════════════════════
PROCESSING combined_event_well_links_11km.csv (radius: 11 km)
2025-06-04 11:59:35,872 | INFO    | ⏳  Loading linkage CSV (combined_event_well_links_11km.csv) …
2025-06-04 11:59:35,970 | INFO    | ✅  Loading linkage CSV (combined_event_well_links_11km.csv) – done in 0.1s
2025-06-04 11:59:35,970 | INFO    | Rows in linkage CSV : 130,215
2025-06-04 11:59:35,972 | INFO    | Magnitude stats for ALL rows: mean=1.149, non-zero=89264/130215 (68.6%)
2025-06-04 11:59:35,972 | INFO    | Magnitude stats for rows with GOOD coordinates: mean=1.149, non-zero=89264/130215 (68.6%)
2025-06-04 11:59:36,097 | INFO    | ⏳  Nearest-fault search …
2025-06-04 11:59:36,438 | INFO    | ✅  Nearest-fault search – done in 0.3s
2025-06-04 11:59:36,442 | INFO    | ⏳  Counting segments ≤11 km …
2025-06-04 11:59:41,250 | INFO    | ✅  Counting segments ≤11 km – done in 4.8s
2025-06-04 11:59:41,250 | INFO    | All wells matched to ≥1 fault ✔️
2025-06-04 11:59:53,668 | INFO    | Saved augmented CSV with ALL rows → event_well_links_with_faults_11km.csv
2025-06-04 11:59:53,668 | INFO    | 🎉  Finished processing combined_event_well_links_11km.csv – runtime 17.8s
2025-06-04 11:59:53,701 | INFO    | 
Processing file 12 of 20: combined_event_well_links_12km.csv
2025-06-04 11:59:53,701 | INFO    | 
══════════════════════════════════════════════════════════════════════════════
PROCESSING combined_event_well_links_12km.csv (radius: 12 km)
2025-06-04 11:59:53,701 | INFO    | ⏳  Loading linkage CSV (combined_event_well_links_12km.csv) …
2025-06-04 11:59:53,828 | INFO    | ✅  Loading linkage CSV (combined_event_well_links_12km.csv) – done in 0.1s
2025-06-04 11:59:53,829 | INFO    | Rows in linkage CSV : 150,203
2025-06-04 11:59:53,831 | INFO    | Magnitude stats for ALL rows: mean=1.132, non-zero=101818/150203 (67.8%)
2025-06-04 11:59:53,831 | INFO    | Magnitude stats for rows with GOOD coordinates: mean=1.132, non-zero=101818/150203 (67.8%)
2025-06-04 11:59:53,986 | INFO    | ⏳  Nearest-fault search …
2025-06-04 11:59:54,381 | INFO    | ✅  Nearest-fault search – done in 0.4s
2025-06-04 11:59:54,387 | INFO    | ⏳  Counting segments ≤12 km …
2025-06-04 12:00:00,724 | INFO    | ✅  Counting segments ≤12 km – done in 6.3s
2025-06-04 12:00:00,724 | INFO    | All wells matched to ≥1 fault ✔️
2025-06-04 12:00:14,848 | INFO    | Saved augmented CSV with ALL rows → event_well_links_with_faults_12km.csv
2025-06-04 12:00:14,848 | INFO    | 🎉  Finished processing combined_event_well_links_12km.csv – runtime 21.1s
2025-06-04 12:00:14,885 | INFO    | 
Processing file 13 of 20: combined_event_well_links_13km.csv
2025-06-04 12:00:14,885 | INFO    | 
══════════════════════════════════════════════════════════════════════════════
PROCESSING combined_event_well_links_13km.csv (radius: 13 km)
2025-06-04 12:00:14,885 | INFO    | ⏳  Loading linkage CSV (combined_event_well_links_13km.csv) …
2025-06-04 12:00:15,020 | INFO    | ✅  Loading linkage CSV (combined_event_well_links_13km.csv) – done in 0.1s
2025-06-04 12:00:15,020 | INFO    | Rows in linkage CSV : 170,893
2025-06-04 12:00:15,023 | INFO    | Magnitude stats for ALL rows: mean=1.118, non-zero=114685/170893 (67.1%)
2025-06-04 12:00:15,023 | INFO    | Magnitude stats for rows with GOOD coordinates: mean=1.118, non-zero=114685/170893 (67.1%)
2025-06-04 12:00:15,192 | INFO    | ⏳  Nearest-fault search …
2025-06-04 12:00:15,648 | INFO    | ✅  Nearest-fault search – done in 0.5s
2025-06-04 12:00:15,654 | INFO    | ⏳  Counting segments ≤13 km …
2025-06-04 12:00:23,837 | INFO    | ✅  Counting segments ≤13 km – done in 8.2s
2025-06-04 12:00:23,837 | INFO    | All wells matched to ≥1 fault ✔️
2025-06-04 12:00:39,938 | INFO    | Saved augmented CSV with ALL rows → event_well_links_with_faults_13km.csv
2025-06-04 12:00:39,938 | INFO    | 🎉  Finished processing combined_event_well_links_13km.csv – runtime 25.1s
2025-06-04 12:00:39,979 | INFO    | 
Processing file 14 of 20: combined_event_well_links_14km.csv
2025-06-04 12:00:39,979 | INFO    | 
══════════════════════════════════════════════════════════════════════════════
PROCESSING combined_event_well_links_14km.csv (radius: 14 km)
2025-06-04 12:00:39,979 | INFO    | ⏳  Loading linkage CSV (combined_event_well_links_14km.csv) …
2025-06-04 12:00:40,133 | INFO    | ✅  Loading linkage CSV (combined_event_well_links_14km.csv) – done in 0.2s
2025-06-04 12:00:40,133 | INFO    | Rows in linkage CSV : 192,249
2025-06-04 12:00:40,135 | INFO    | Magnitude stats for ALL rows: mean=1.106, non-zero=128046/192249 (66.6%)
2025-06-04 12:00:40,135 | INFO    | Magnitude stats for rows with GOOD coordinates: mean=1.106, non-zero=128046/192249 (66.6%)
2025-06-04 12:00:40,323 | INFO    | ⏳  Nearest-fault search …
2025-06-04 12:00:40,834 | INFO    | ✅  Nearest-fault search – done in 0.5s
2025-06-04 12:00:40,841 | INFO    | ⏳  Counting segments ≤14 km …
2025-06-04 12:00:51,311 | INFO    | ✅  Counting segments ≤14 km – done in 10.5s
2025-06-04 12:00:51,311 | INFO    | All wells matched to ≥1 fault ✔️
2025-06-04 12:01:09,562 | INFO    | Saved augmented CSV with ALL rows → event_well_links_with_faults_14km.csv
2025-06-04 12:01:09,562 | INFO    | 🎉  Finished processing combined_event_well_links_14km.csv – runtime 29.6s
2025-06-04 12:01:09,609 | INFO    | 
Processing file 15 of 20: combined_event_well_links_15km.csv
2025-06-04 12:01:09,609 | INFO    | 
══════════════════════════════════════════════════════════════════════════════
PROCESSING combined_event_well_links_15km.csv (radius: 15 km)
2025-06-04 12:01:09,609 | INFO    | ⏳  Loading linkage CSV (combined_event_well_links_15km.csv) …
2025-06-04 12:01:09,776 | INFO    | ✅  Loading linkage CSV (combined_event_well_links_15km.csv) – done in 0.2s
2025-06-04 12:01:09,776 | INFO    | Rows in linkage CSV : 215,258
2025-06-04 12:01:09,780 | INFO    | Magnitude stats for ALL rows: mean=1.098, non-zero=142760/215258 (66.3%)
2025-06-04 12:01:09,780 | INFO    | Magnitude stats for rows with GOOD coordinates: mean=1.098, non-zero=142760/215258 (66.3%)
2025-06-04 12:01:09,995 | INFO    | ⏳  Nearest-fault search …
2025-06-04 12:01:10,572 | INFO    | ✅  Nearest-fault search – done in 0.6s
2025-06-04 12:01:10,579 | INFO    | ⏳  Counting segments ≤15 km …
2025-06-04 12:01:23,766 | INFO    | ✅  Counting segments ≤15 km – done in 13.2s
2025-06-04 12:01:23,767 | INFO    | All wells matched to ≥1 fault ✔️
2025-06-04 12:01:44,272 | INFO    | Saved augmented CSV with ALL rows → event_well_links_with_faults_15km.csv
2025-06-04 12:01:44,272 | INFO    | 🎉  Finished processing combined_event_well_links_15km.csv – runtime 34.7s
2025-06-04 12:01:44,330 | INFO    | 
Processing file 16 of 20: combined_event_well_links_16km.csv
2025-06-04 12:01:44,330 | INFO    | 
══════════════════════════════════════════════════════════════════════════════
PROCESSING combined_event_well_links_16km.csv (radius: 16 km)
2025-06-04 12:01:44,330 | INFO    | ⏳  Loading linkage CSV (combined_event_well_links_16km.csv) …
2025-06-04 12:01:44,521 | INFO    | ✅  Loading linkage CSV (combined_event_well_links_16km.csv) – done in 0.2s
2025-06-04 12:01:44,521 | INFO    | Rows in linkage CSV : 238,280
2025-06-04 12:01:44,525 | INFO    | Magnitude stats for ALL rows: mean=1.091, non-zero=157471/238280 (66.1%)
2025-06-04 12:01:44,525 | INFO    | Magnitude stats for rows with GOOD coordinates: mean=1.091, non-zero=157471/238280 (66.1%)
2025-06-04 12:01:44,764 | INFO    | ⏳  Nearest-fault search …
2025-06-04 12:01:45,417 | INFO    | ✅  Nearest-fault search – done in 0.7s
2025-06-04 12:01:45,425 | INFO    | ⏳  Counting segments ≤16 km …
2025-06-04 12:02:01,800 | INFO    | ✅  Counting segments ≤16 km – done in 16.4s
2025-06-04 12:02:01,800 | INFO    | All wells matched to ≥1 fault ✔️
2025-06-04 12:02:24,426 | INFO    | Saved augmented CSV with ALL rows → event_well_links_with_faults_16km.csv
2025-06-04 12:02:24,426 | INFO    | 🎉  Finished processing combined_event_well_links_16km.csv – runtime 40.1s
2025-06-04 12:02:24,485 | INFO    | 
Processing file 17 of 20: combined_event_well_links_17km.csv
2025-06-04 12:02:24,485 | INFO    | 
══════════════════════════════════════════════════════════════════════════════
PROCESSING combined_event_well_links_17km.csv (radius: 17 km)
2025-06-04 12:02:24,485 | INFO    | ⏳  Loading linkage CSV (combined_event_well_links_17km.csv) …
2025-06-04 12:02:24,687 | INFO    | ✅  Loading linkage CSV (combined_event_well_links_17km.csv) – done in 0.2s
2025-06-04 12:02:24,687 | INFO    | Rows in linkage CSV : 263,078
2025-06-04 12:02:24,691 | INFO    | Magnitude stats for ALL rows: mean=1.080, non-zero=172552/263078 (65.6%)
2025-06-04 12:02:24,691 | INFO    | Magnitude stats for rows with GOOD coordinates: mean=1.080, non-zero=172552/263078 (65.6%)
2025-06-04 12:02:24,948 | INFO    | ⏳  Nearest-fault search …
2025-06-04 12:02:25,666 | INFO    | ✅  Nearest-fault search – done in 0.7s
2025-06-04 12:02:25,675 | INFO    | ⏳  Counting segments ≤17 km …
2025-06-04 12:02:45,394 | INFO    | ✅  Counting segments ≤17 km – done in 19.7s
2025-06-04 12:02:45,395 | INFO    | All wells matched to ≥1 fault ✔️
2025-06-04 12:03:10,120 | INFO    | Saved augmented CSV with ALL rows → event_well_links_with_faults_17km.csv
2025-06-04 12:03:10,120 | INFO    | 🎉  Finished processing combined_event_well_links_17km.csv – runtime 45.6s
2025-06-04 12:03:10,184 | INFO    | 
Processing file 18 of 20: combined_event_well_links_18km.csv
2025-06-04 12:03:10,184 | INFO    | 
══════════════════════════════════════════════════════════════════════════════
PROCESSING combined_event_well_links_18km.csv (radius: 18 km)
2025-06-04 12:03:10,184 | INFO    | ⏳  Loading linkage CSV (combined_event_well_links_18km.csv) …
2025-06-04 12:03:10,418 | INFO    | ✅  Loading linkage CSV (combined_event_well_links_18km.csv) – done in 0.2s
2025-06-04 12:03:10,418 | INFO    | Rows in linkage CSV : 290,036
2025-06-04 12:03:10,422 | INFO    | Magnitude stats for ALL rows: mean=1.071, non-zero=189120/290036 (65.2%)
2025-06-04 12:03:10,423 | INFO    | Magnitude stats for rows with GOOD coordinates: mean=1.071, non-zero=189120/290036 (65.2%)
2025-06-04 12:03:10,693 | INFO    | ⏳  Nearest-fault search …
2025-06-04 12:03:11,490 | INFO    | ✅  Nearest-fault search – done in 0.8s
2025-06-04 12:03:11,500 | INFO    | ⏳  Counting segments ≤18 km …
2025-06-04 12:03:35,605 | INFO    | ✅  Counting segments ≤18 km – done in 24.1s
2025-06-04 12:03:35,605 | INFO    | All wells matched to ≥1 fault ✔️
2025-06-04 12:04:03,150 | INFO    | Saved augmented CSV with ALL rows → event_well_links_with_faults_18km.csv
2025-06-04 12:04:03,150 | INFO    | 🎉  Finished processing combined_event_well_links_18km.csv – runtime 53.0s
2025-06-04 12:04:03,222 | INFO    | 
Processing file 19 of 20: combined_event_well_links_19km.csv
2025-06-04 12:04:03,222 | INFO    | 
══════════════════════════════════════════════════════════════════════════════
PROCESSING combined_event_well_links_19km.csv (radius: 19 km)
2025-06-04 12:04:03,223 | INFO    | ⏳  Loading linkage CSV (combined_event_well_links_19km.csv) …
2025-06-04 12:04:03,483 | INFO    | ✅  Loading linkage CSV (combined_event_well_links_19km.csv) – done in 0.3s
2025-06-04 12:04:03,483 | INFO    | Rows in linkage CSV : 316,778
2025-06-04 12:04:03,488 | INFO    | Magnitude stats for ALL rows: mean=1.062, non-zero=205221/316778 (64.8%)
2025-06-04 12:04:03,488 | INFO    | Magnitude stats for rows with GOOD coordinates: mean=1.062, non-zero=205221/316778 (64.8%)
2025-06-04 12:04:03,806 | INFO    | ⏳  Nearest-fault search …
2025-06-04 12:04:04,682 | INFO    | ✅  Nearest-fault search – done in 0.9s
2025-06-04 12:04:04,693 | INFO    | ⏳  Counting segments ≤19 km …
2025-06-04 12:04:33,227 | INFO    | ✅  Counting segments ≤19 km – done in 28.5s
2025-06-04 12:04:33,227 | INFO    | All wells matched to ≥1 fault ✔️
2025-06-04 12:05:03,152 | INFO    | Saved augmented CSV with ALL rows → event_well_links_with_faults_19km.csv
2025-06-04 12:05:03,152 | INFO    | 🎉  Finished processing combined_event_well_links_19km.csv – runtime 59.9s
2025-06-04 12:05:03,230 | INFO    | 
Processing file 20 of 20: combined_event_well_links_20km.csv
2025-06-04 12:05:03,230 | INFO    | 
══════════════════════════════════════════════════════════════════════════════
PROCESSING combined_event_well_links_20km.csv (radius: 20 km)
2025-06-04 12:05:03,230 | INFO    | ⏳  Loading linkage CSV (combined_event_well_links_20km.csv) …
2025-06-04 12:05:03,515 | INFO    | ✅  Loading linkage CSV (combined_event_well_links_20km.csv) – done in 0.3s
2025-06-04 12:05:03,515 | INFO    | Rows in linkage CSV : 342,463
2025-06-04 12:05:03,519 | INFO    | Magnitude stats for ALL rows: mean=1.055, non-zero=220739/342463 (64.5%)
2025-06-04 12:05:03,519 | INFO    | Magnitude stats for rows with GOOD coordinates: mean=1.055, non-zero=220739/342463 (64.5%)
2025-06-04 12:05:03,859 | INFO    | ⏳  Nearest-fault search …
2025-06-04 12:05:04,817 | INFO    | ✅  Nearest-fault search – done in 1.0s
2025-06-04 12:05:04,829 | INFO    | ⏳  Counting segments ≤20 km …
2025-06-04 12:05:38,485 | INFO    | ✅  Counting segments ≤20 km – done in 33.7s
2025-06-04 12:05:38,486 | INFO    | All wells matched to ≥1 fault ✔️
2025-06-04 12:06:10,997 | INFO    | Saved augmented CSV with ALL rows → event_well_links_with_faults_20km.csv
2025-06-04 12:06:10,997 | INFO    | 🎉  Finished processing combined_event_well_links_20km.csv – runtime 67.8s
2025-06-04 12:06:11,081 | INFO    | 
══════════════════════════════════════════════════════════════════════════════
🎉 ALL FILES PROCESSED SUCCESSFULLY – Total runtime: 450.3s

2025-06-04 12:06:11,176 - INFO - ✓ Completed add_geoscience_to_event_well_links_with_injection.py in 450.86 seconds

2025-06-04 12:06:11,176 - INFO - 
################################################################################
2025-06-04 12:06:11,176 - INFO - # STEP 5: MULTI-RADIUS CAUSAL SENSITIVITY ANALYSIS
2025-06-04 12:06:11,176 - INFO - ################################################################################

2025-06-04 12:06:11,176 - INFO - ======================================================================
2025-06-04 12:06:11,176 - INFO - Running: dowhy_simple_all.py
2025-06-04 12:06:11,176 - INFO - Purpose: Well-level causal analysis using DoWhy framework
2025-06-04 12:06:11,176 - INFO - ======================================================================
2025-06-04 12:08:36,127 - INFO - Output:

================================================================================
BATCH CAUSAL ANALYSIS WITH MEDIATION
================================================================================

Processing file 1 of 20: event_well_links_with_faults_1km.csv

================================================================================
PROCESSING: event_well_links_with_faults_1km.csv (radius: 1 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_1km.csv) … done in 0.0s

🔎  Auto-detecting required columns:
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤1 km

🕵️  Missing-value summary:
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤1 km                : 0 NA (0.0%)
Dropped 0 rows missing treatment or outcome (0.0%)
✅  Rows after cleaning: 1177

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL)
    DoWhy point estimate : +6.472e-06
    Statsmodels p-value  : 2.07e-02

🔄  Running mediation analysis...
Path a (W → P)  : +0.02532 (p=1.5e-44)
Path b (P → S)  : +0.0003893 (p=4.97e-17)
Total effect    : +6.472e-06 (p=0.0207)
Direct effect   : -3.386e-06 (p=0.251)
Indirect effect : +9.858e-06
Proportion mediated: 152.3%

⏳  Running refutation checks … done in 0.8s

🔍  Refutation checks (effect should stay similar)
    Placebo : +1.354e-07
    Subset  : +8.355e-06

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.8969
    R²   : 0.0918

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 1 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +6.472e-06
Direct effect (W → S)           : -3.386e-06
Indirect effect (W → P → S)     : +9.858e-06
Percentage mediated by pressure : 152.3%
─────────────────────────────────────────────────────

Processing file 2 of 20: event_well_links_with_faults_2km.csv

================================================================================
PROCESSING: event_well_links_with_faults_2km.csv (radius: 2 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_2km.csv) … done in 0.0s

🔎  Auto-detecting required columns:
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤2 km

🕵️  Missing-value summary:
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤2 km                : 0 NA (0.0%)
Dropped 0 rows missing treatment or outcome (0.0%)
✅  Rows after cleaning: 4778

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL)
    DoWhy point estimate : +2.337e-05
    Statsmodels p-value  : 3.10e-30

🔄  Running mediation analysis...
Path a (W → P)  : +0.0488 (p=3.19e-310)
Path b (P → S)  : +0.0004024 (p=1.86e-62)
Total effect    : +2.337e-05 (p=3.1e-30)
Direct effect   : +3.731e-06 (p=0.103)
Indirect effect : +1.964e-05
Proportion mediated: 84.0%

⏳  Running refutation checks … done in 1.5s

🔍  Refutation checks (effect should stay similar)
    Placebo : -8.222e-08
    Subset  : +2.429e-05

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.8219
    R²   : 0.1936

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 2 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +2.337e-05
Direct effect (W → S)           : +3.731e-06
Indirect effect (W → P → S)     : +1.964e-05
Percentage mediated by pressure : 84.0%
─────────────────────────────────────────────────────

Processing file 3 of 20: event_well_links_with_faults_3km.csv

================================================================================
PROCESSING: event_well_links_with_faults_3km.csv (radius: 3 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_3km.csv) … done in 0.1s

🔎  Auto-detecting required columns:
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤3 km

🕵️  Missing-value summary:
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤3 km                : 0 NA (0.0%)
Dropped 0 rows missing treatment or outcome (0.0%)
✅  Rows after cleaning: 11649

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2

⏳  Estimating total causal effect … done in 0.2s

📈  TOTAL causal effect (ΔMagnitude per extra BBL)
    DoWhy point estimate : +3.031e-05
    Statsmodels p-value  : 8.46e-100

🔄  Running mediation analysis...
Path a (W → P)  : +0.05812 (p=0)
Path b (P → S)  : +0.0003261 (p=6.75e-93)
Total effect    : +3.031e-05 (p=8.46e-100)
Direct effect   : +1.136e-05 (p=9.75e-12)
Indirect effect : +1.895e-05
Proportion mediated: 62.5%

⏳  Running refutation checks … done in 1.6s

🔍  Refutation checks (effect should stay similar)
    Placebo : -1.714e-08
    Subset  : +3.044e-05

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.8292
    R²   : 0.1797

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 3 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +3.031e-05
Direct effect (W → S)           : +1.136e-05
Indirect effect (W → P → S)     : +1.895e-05
Percentage mediated by pressure : 62.5%
─────────────────────────────────────────────────────

Processing file 4 of 20: event_well_links_with_faults_4km.csv

================================================================================
PROCESSING: event_well_links_with_faults_4km.csv (radius: 4 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_4km.csv) … done in 0.0s

🔎  Auto-detecting required columns:
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤4 km

🕵️  Missing-value summary:
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤4 km                : 0 NA (0.0%)
Dropped 0 rows missing treatment or outcome (0.0%)
✅  Rows after cleaning: 20292

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL)
    DoWhy point estimate : +3.137e-05
    Statsmodels p-value  : 2.61e-183

🔄  Running mediation analysis...
Path a (W → P)  : +0.06377 (p=0)
Path b (P → S)  : +0.000237 (p=2.56e-105)
Total effect    : +3.137e-05 (p=2.61e-183)
Direct effect   : +1.626e-05 (p=1.45e-37)
Indirect effect : +1.511e-05
Proportion mediated: 48.2%

⏳  Running refutation checks … done in 1.9s

🔍  Refutation checks (effect should stay similar)
    Placebo : +1.073e-07
    Subset  : +3.158e-05

⏳  Training predictive sanity-check model … done in 0.2s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.8092
    R²   : 0.1894

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 4 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +3.137e-05
Direct effect (W → S)           : +1.626e-05
Indirect effect (W → P → S)     : +1.511e-05
Percentage mediated by pressure : 48.2%
─────────────────────────────────────────────────────

Processing file 5 of 20: event_well_links_with_faults_5km.csv

================================================================================
PROCESSING: event_well_links_with_faults_5km.csv (radius: 5 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_5km.csv) … done in 0.0s

🔎  Auto-detecting required columns:
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤5 km

🕵️  Missing-value summary:
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤5 km                : 0 NA (0.0%)
Dropped 0 rows missing treatment or outcome (0.0%)
✅  Rows after cleaning: 30460

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2

⏳  Estimating total causal effect … done in 0.1s

📈  TOTAL causal effect (ΔMagnitude per extra BBL)
    DoWhy point estimate : +2.456e-05
    Statsmodels p-value  : 1.26e-200

🔄  Running mediation analysis...
Path a (W → P)  : +0.05539 (p=0)
Path b (P → S)  : +0.0002811 (p=3.35e-217)
Total effect    : +2.456e-05 (p=1.26e-200)
Direct effect   : +8.988e-06 (p=6.4e-22)
Indirect effect : +1.557e-05
Proportion mediated: 63.4%

⏳  Running refutation checks … done in 2.8s

🔍  Refutation checks (effect should stay similar)
    Placebo : -3.742e-08
    Subset  : +2.447e-05

⏳  Training predictive sanity-check model … done in 0.3s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.8280
    R²   : 0.1703

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 5 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +2.456e-05
Direct effect (W → S)           : +8.988e-06
Indirect effect (W → P → S)     : +1.557e-05
Percentage mediated by pressure : 63.4%
─────────────────────────────────────────────────────

Processing file 6 of 20: event_well_links_with_faults_6km.csv

================================================================================
PROCESSING: event_well_links_with_faults_6km.csv (radius: 6 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_6km.csv) … done in 0.1s

🔎  Auto-detecting required columns:
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤6 km

🕵️  Missing-value summary:
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤6 km                : 0 NA (0.0%)
Dropped 0 rows missing treatment or outcome (0.0%)
✅  Rows after cleaning: 42185

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2

⏳  Estimating total causal effect … done in 0.1s

📈  TOTAL causal effect (ΔMagnitude per extra BBL)
    DoWhy point estimate : +1.417e-05
    Statsmodels p-value  : 7.79e-146

🔄  Running mediation analysis...
Path a (W → P)  : +0.03507 (p=0)
Path b (P → S)  : +0.0003206 (p=0)
Total effect    : +1.417e-05 (p=7.79e-146)
Direct effect   : +2.929e-06 (p=7.39e-07)
Indirect effect : +1.124e-05
Proportion mediated: 79.3%

⏳  Running refutation checks … done in 2.9s

🔍  Refutation checks (effect should stay similar)
    Placebo : -5.791e-08
    Subset  : +1.429e-05

⏳  Training predictive sanity-check model … done in 0.2s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.8211
    R²   : 0.1712

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 6 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +1.417e-05
Direct effect (W → S)           : +2.929e-06
Indirect effect (W → P → S)     : +1.124e-05
Percentage mediated by pressure : 79.3%
─────────────────────────────────────────────────────

Processing file 7 of 20: event_well_links_with_faults_7km.csv

================================================================================
PROCESSING: event_well_links_with_faults_7km.csv (radius: 7 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_7km.csv) … done in 0.1s

🔎  Auto-detecting required columns:
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤7 km

🕵️  Missing-value summary:
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤7 km                : 0 NA (0.0%)
Dropped 0 rows missing treatment or outcome (0.0%)
✅  Rows after cleaning: 55955

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL)
    DoWhy point estimate : +1.461e-05
    Statsmodels p-value  : 1.62e-202

🔄  Running mediation analysis...
Path a (W → P)  : +0.0362 (p=0)
Path b (P → S)  : +0.0003159 (p=0)
Total effect    : +1.461e-05 (p=1.62e-202)
Direct effect   : +3.173e-06 (p=9.11e-10)
Indirect effect : +1.144e-05
Proportion mediated: 78.3%

⏳  Running refutation checks … done in 3.4s

🔍  Refutation checks (effect should stay similar)
    Placebo : -2.789e-08
    Subset  : +1.477e-05

⏳  Training predictive sanity-check model … done in 0.2s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.8283
    R²   : 0.1708

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 7 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +1.461e-05
Direct effect (W → S)           : +3.173e-06
Indirect effect (W → P → S)     : +1.144e-05
Percentage mediated by pressure : 78.3%
─────────────────────────────────────────────────────

Processing file 8 of 20: event_well_links_with_faults_8km.csv

================================================================================
PROCESSING: event_well_links_with_faults_8km.csv (radius: 8 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_8km.csv) … done in 0.1s

🔎  Auto-detecting required columns:
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤8 km

🕵️  Missing-value summary:
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤8 km                : 0 NA (0.0%)
Dropped 0 rows missing treatment or outcome (0.0%)
✅  Rows after cleaning: 72116

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL)
    DoWhy point estimate : +7.607e-06
    Statsmodels p-value  : 3.13e-116

🔄  Running mediation analysis...
Path a (W → P)  : +0.02245 (p=0)
Path b (P → S)  : +0.0003216 (p=0)
Total effect    : +7.607e-06 (p=3.13e-116)
Direct effect   : +3.877e-07 (p=0.258)
Indirect effect : +7.219e-06
Proportion mediated: 94.9%

⏳  Running refutation checks … done in 3.9s

🔍  Refutation checks (effect should stay similar)
    Placebo : +1.885e-08
    Subset  : +7.625e-06

⏳  Training predictive sanity-check model … done in 0.3s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.8443
    R²   : 0.1528

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 8 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +7.607e-06
Direct effect (W → S)           : +3.877e-07
Indirect effect (W → P → S)     : +7.219e-06
Percentage mediated by pressure : 94.9%
─────────────────────────────────────────────────────

Processing file 9 of 20: event_well_links_with_faults_9km.csv

================================================================================
PROCESSING: event_well_links_with_faults_9km.csv (radius: 9 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_9km.csv) … done in 0.2s

🔎  Auto-detecting required columns:
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤9 km

🕵️  Missing-value summary:
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤9 km                : 0 NA (0.0%)
Dropped 0 rows missing treatment or outcome (0.0%)
✅  Rows after cleaning: 90728

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL)
    DoWhy point estimate : +7.969e-06
    Statsmodels p-value  : 1.06e-157

🔄  Running mediation analysis...
Path a (W → P)  : +0.02279 (p=0)
Path b (P → S)  : +0.0003347 (p=0)
Total effect    : +7.969e-06 (p=1.06e-157)
Direct effect   : +3.42e-07 (p=0.266)
Indirect effect : +7.627e-06
Proportion mediated: 95.7%

⏳  Running refutation checks … done in 4.8s

🔍  Refutation checks (effect should stay similar)
    Placebo : +3.273e-08
    Subset  : +8.054e-06

⏳  Training predictive sanity-check model … done in 0.2s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.8400
    R²   : 0.1596

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 9 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +7.969e-06
Direct effect (W → S)           : +3.42e-07
Indirect effect (W → P → S)     : +7.627e-06
Percentage mediated by pressure : 95.7%
─────────────────────────────────────────────────────

Processing file 10 of 20: event_well_links_with_faults_10km.csv

================================================================================
PROCESSING: event_well_links_with_faults_10km.csv (radius: 10 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_10km.csv) … done in 0.2s

🔎  Auto-detecting required columns:
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤10 km

🕵️  Missing-value summary:
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤10 km               : 0 NA (0.0%)
Dropped 0 rows missing treatment or outcome (0.0%)
✅  Rows after cleaning: 110014

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2

⏳  Estimating total causal effect … done in 0.1s

📈  TOTAL causal effect (ΔMagnitude per extra BBL)
    DoWhy point estimate : +9.095e-06
    Statsmodels p-value  : 2.86e-234

🔄  Running mediation analysis...
Path a (W → P)  : +0.02422 (p=0)
Path b (P → S)  : +0.000345 (p=0)
Total effect    : +9.095e-06 (p=2.86e-234)
Direct effect   : +7.399e-07 (p=0.0103)
Indirect effect : +8.355e-06
Proportion mediated: 91.9%

⏳  Running refutation checks … done in 5.7s

🔍  Refutation checks (effect should stay similar)
    Placebo : -4.182e-10
    Subset  : +9.064e-06

⏳  Training predictive sanity-check model … done in 0.3s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.8416
    R²   : 0.1558

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 10 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +9.095e-06
Direct effect (W → S)           : +7.399e-07
Indirect effect (W → P → S)     : +8.355e-06
Percentage mediated by pressure : 91.9%
─────────────────────────────────────────────────────

Processing file 11 of 20: event_well_links_with_faults_11km.csv

================================================================================
PROCESSING: event_well_links_with_faults_11km.csv (radius: 11 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_11km.csv) … done in 0.2s

🔎  Auto-detecting required columns:
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤11 km

🕵️  Missing-value summary:
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤11 km               : 0 NA (0.0%)
Dropped 0 rows missing treatment or outcome (0.0%)
✅  Rows after cleaning: 130215

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL)
    DoWhy point estimate : +8.176e-06
    Statsmodels p-value  : 9.62e-248

🔄  Running mediation analysis...
Path a (W → P)  : +0.02188 (p=0)
Path b (P → S)  : +0.0003622 (p=0)
Total effect    : +8.176e-06 (p=9.62e-248)
Direct effect   : +2.52e-07 (p=0.313)
Indirect effect : +7.924e-06
Proportion mediated: 96.9%

⏳  Running refutation checks … done in 6.0s

🔍  Refutation checks (effect should stay similar)
    Placebo : -2.135e-08
    Subset  : +8.172e-06

⏳  Training predictive sanity-check model … done in 0.3s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.8468
    R²   : 0.1545

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 11 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +8.176e-06
Direct effect (W → S)           : +2.52e-07
Indirect effect (W → P → S)     : +7.924e-06
Percentage mediated by pressure : 96.9%
─────────────────────────────────────────────────────

Processing file 12 of 20: event_well_links_with_faults_12km.csv

================================================================================
PROCESSING: event_well_links_with_faults_12km.csv (radius: 12 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_12km.csv) … done in 0.3s

🔎  Auto-detecting required columns:
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤12 km

🕵️  Missing-value summary:
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤12 km               : 0 NA (0.0%)
Dropped 0 rows missing treatment or outcome (0.0%)
✅  Rows after cleaning: 150203

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2

⏳  Estimating total causal effect … done in 0.1s

📈  TOTAL causal effect (ΔMagnitude per extra BBL)
    DoWhy point estimate : +6.199e-06
    Statsmodels p-value  : 1.58e-203

🔄  Running mediation analysis...
Path a (W → P)  : +0.01782 (p=0)
Path b (P → S)  : +0.0003707 (p=0)
Total effect    : +6.199e-06 (p=1.58e-203)
Direct effect   : -4.069e-07 (p=0.0486)
Indirect effect : +6.606e-06
Proportion mediated: 106.6%

⏳  Running refutation checks … done in 7.6s

🔍  Refutation checks (effect should stay similar)
    Placebo : +1.541e-08
    Subset  : +6.193e-06

⏳  Training predictive sanity-check model … done in 0.2s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.8505
    R²   : 0.1559

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 12 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +6.199e-06
Direct effect (W → S)           : -4.069e-07
Indirect effect (W → P → S)     : +6.606e-06
Percentage mediated by pressure : 106.6%
─────────────────────────────────────────────────────

Processing file 13 of 20: event_well_links_with_faults_13km.csv

================================================================================
PROCESSING: event_well_links_with_faults_13km.csv (radius: 13 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_13km.csv) … done in 0.2s

🔎  Auto-detecting required columns:
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤13 km

🕵️  Missing-value summary:
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤13 km               : 0 NA (0.0%)
Dropped 0 rows missing treatment or outcome (0.0%)
✅  Rows after cleaning: 170893

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2

⏳  Estimating total causal effect … done in 0.1s

📈  TOTAL causal effect (ΔMagnitude per extra BBL)
    DoWhy point estimate : +4.725e-06
    Statsmodels p-value  : 3.67e-170

🔄  Running mediation analysis...
Path a (W → P)  : +0.01429 (p=0)
Path b (P → S)  : +0.0003645 (p=0)
Total effect    : +4.725e-06 (p=3.67e-170)
Direct effect   : -4.844e-07 (p=0.00449)
Indirect effect : +5.21e-06
Proportion mediated: 110.3%

⏳  Running refutation checks … done in 7.5s

🔍  Refutation checks (effect should stay similar)
    Placebo : -9.093e-10
    Subset  : +4.722e-06

⏳  Training predictive sanity-check model … done in 0.2s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.8402
    R²   : 0.1622

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 13 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +4.725e-06
Direct effect (W → S)           : -4.844e-07
Indirect effect (W → P → S)     : +5.21e-06
Percentage mediated by pressure : 110.3%
─────────────────────────────────────────────────────

Processing file 14 of 20: event_well_links_with_faults_14km.csv

================================================================================
PROCESSING: event_well_links_with_faults_14km.csv (radius: 14 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_14km.csv) … done in 0.3s

🔎  Auto-detecting required columns:
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤14 km

🕵️  Missing-value summary:
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤14 km               : 0 NA (0.0%)
Dropped 0 rows missing treatment or outcome (0.0%)
✅  Rows after cleaning: 192249

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2

⏳  Estimating total causal effect … done in 0.1s

📈  TOTAL causal effect (ΔMagnitude per extra BBL)
    DoWhy point estimate : +4.727e-06
    Statsmodels p-value  : 2.96e-199

🔄  Running mediation analysis...
Path a (W → P)  : +0.01382 (p=0)
Path b (P → S)  : +0.0003617 (p=0)
Total effect    : +4.727e-06 (p=2.96e-199)
Direct effect   : -2.739e-07 (p=0.0812)
Indirect effect : +5.001e-06
Proportion mediated: 105.8%

⏳  Running refutation checks … done in 9.1s

🔍  Refutation checks (effect should stay similar)
    Placebo : +1.273e-09
    Subset  : +4.713e-06

⏳  Training predictive sanity-check model … done in 0.2s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.8397
    R²   : 0.1699

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 14 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +4.727e-06
Direct effect (W → S)           : -2.739e-07
Indirect effect (W → P → S)     : +5.001e-06
Percentage mediated by pressure : 105.8%
─────────────────────────────────────────────────────

Processing file 15 of 20: event_well_links_with_faults_15km.csv

================================================================================
PROCESSING: event_well_links_with_faults_15km.csv (radius: 15 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_15km.csv) … done in 0.3s

🔎  Auto-detecting required columns:
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤15 km

🕵️  Missing-value summary:
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤15 km               : 0 NA (0.0%)
Dropped 0 rows missing treatment or outcome (0.0%)
✅  Rows after cleaning: 215258

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL)
    DoWhy point estimate : +4.464e-06
    Statsmodels p-value  : 2.70e-215

🔄  Running mediation analysis...
Path a (W → P)  : +0.01312 (p=0)
Path b (P → S)  : +0.0003665 (p=0)
Total effect    : +4.464e-06 (p=2.7e-215)
Direct effect   : -3.448e-07 (p=0.0153)
Indirect effect : +4.809e-06
Proportion mediated: 107.7%

⏳  Running refutation checks … done in 9.2s

🔍  Refutation checks (effect should stay similar)
    Placebo : -4.963e-09
    Subset  : +4.446e-06

⏳  Training predictive sanity-check model … done in 0.3s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.8421
    R²   : 0.1711

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 15 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +4.464e-06
Direct effect (W → S)           : -3.448e-07
Indirect effect (W → P → S)     : +4.809e-06
Percentage mediated by pressure : 107.7%
─────────────────────────────────────────────────────

Processing file 16 of 20: event_well_links_with_faults_16km.csv

================================================================================
PROCESSING: event_well_links_with_faults_16km.csv (radius: 16 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_16km.csv) … done in 0.4s

🔎  Auto-detecting required columns:
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤16 km

🕵️  Missing-value summary:
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤16 km               : 0 NA (0.0%)
Dropped 0 rows missing treatment or outcome (0.0%)
✅  Rows after cleaning: 238280

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL)
    DoWhy point estimate : +4.115e-06
    Statsmodels p-value  : 1.38e-224

🔄  Running mediation analysis...
Path a (W → P)  : +0.01201 (p=0)
Path b (P → S)  : +0.0003708 (p=0)
Total effect    : +4.115e-06 (p=1.38e-224)
Direct effect   : -3.37e-07 (p=0.00833)
Indirect effect : +4.452e-06
Proportion mediated: 108.2%

⏳  Running refutation checks … done in 9.6s

🔍  Refutation checks (effect should stay similar)
    Placebo : -1.198e-08
    Subset  : +4.128e-06

⏳  Training predictive sanity-check model … done in 0.3s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.8333
    R²   : 0.1712

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 16 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +4.115e-06
Direct effect (W → S)           : -3.37e-07
Indirect effect (W → P → S)     : +4.452e-06
Percentage mediated by pressure : 108.2%
─────────────────────────────────────────────────────

Processing file 17 of 20: event_well_links_with_faults_17km.csv

================================================================================
PROCESSING: event_well_links_with_faults_17km.csv (radius: 17 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_17km.csv) … done in 0.3s

🔎  Auto-detecting required columns:
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤17 km

🕵️  Missing-value summary:
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤17 km               : 0 NA (0.0%)
Dropped 0 rows missing treatment or outcome (0.0%)
✅  Rows after cleaning: 263078

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL)
    DoWhy point estimate : +4.105e-06
    Statsmodels p-value  : 1.28e-256

🔄  Running mediation analysis...
Path a (W → P)  : +0.0116 (p=0)
Path b (P → S)  : +0.0003845 (p=0)
Total effect    : +4.105e-06 (p=1.28e-256)
Direct effect   : -3.573e-07 (p=0.00261)
Indirect effect : +4.462e-06
Proportion mediated: 108.7%

⏳  Running refutation checks … done in 11.1s

🔍  Refutation checks (effect should stay similar)
    Placebo : -8.071e-09
    Subset  : +4.106e-06

⏳  Training predictive sanity-check model … done in 0.3s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.8285
    R²   : 0.1780

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 17 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +4.105e-06
Direct effect (W → S)           : -3.573e-07
Indirect effect (W → P → S)     : +4.462e-06
Percentage mediated by pressure : 108.7%
─────────────────────────────────────────────────────

Processing file 18 of 20: event_well_links_with_faults_18km.csv

================================================================================
PROCESSING: event_well_links_with_faults_18km.csv (radius: 18 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_18km.csv) … done in 0.4s

🔎  Auto-detecting required columns:
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤18 km

🕵️  Missing-value summary:
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤18 km               : 0 NA (0.0%)
Dropped 0 rows missing treatment or outcome (0.0%)
✅  Rows after cleaning: 290036

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL)
    DoWhy point estimate : +3.901e-06
    Statsmodels p-value  : 1.14e-275

🔄  Running mediation analysis...
Path a (W → P)  : +0.01089 (p=0)
Path b (P → S)  : +0.0003983 (p=0)
Total effect    : +3.901e-06 (p=1.14e-275)
Direct effect   : -4.376e-07 (p=5.29e-05)
Indirect effect : +4.339e-06
Proportion mediated: 111.2%

⏳  Running refutation checks … done in 12.6s

🔍  Refutation checks (effect should stay similar)
    Placebo : +1.99e-08
    Subset  : +3.889e-06

⏳  Training predictive sanity-check model … done in 0.4s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.8332
    R²   : 0.1712

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 18 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +3.901e-06
Direct effect (W → S)           : -4.376e-07
Indirect effect (W → P → S)     : +4.339e-06
Percentage mediated by pressure : 111.2%
─────────────────────────────────────────────────────

Processing file 19 of 20: event_well_links_with_faults_19km.csv

================================================================================
PROCESSING: event_well_links_with_faults_19km.csv (radius: 19 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_19km.csv) … done in 0.4s

🔎  Auto-detecting required columns:
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤19 km

🕵️  Missing-value summary:
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤19 km               : 0 NA (0.0%)
Dropped 0 rows missing treatment or outcome (0.0%)
✅  Rows after cleaning: 316778

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2

⏳  Estimating total causal effect … done in 0.1s

📈  TOTAL causal effect (ΔMagnitude per extra BBL)
    DoWhy point estimate : +4.087e-06
    Statsmodels p-value  : 0.00e+00

🔄  Running mediation analysis...
Path a (W → P)  : +0.01098 (p=0)
Path b (P → S)  : +0.0004086 (p=0)
Total effect    : +4.087e-06 (p=0)
Direct effect   : -3.98e-07 (p=0.000122)
Indirect effect : +4.485e-06
Proportion mediated: 109.7%

⏳  Running refutation checks … done in 14.7s

🔍  Refutation checks (effect should stay similar)
    Placebo : +6.842e-09
    Subset  : +4.063e-06

⏳  Training predictive sanity-check model … done in 0.2s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.8227
    R²   : 0.1842

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 19 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +4.087e-06
Direct effect (W → S)           : -3.98e-07
Indirect effect (W → P → S)     : +4.485e-06
Percentage mediated by pressure : 109.7%
─────────────────────────────────────────────────────

Processing file 20 of 20: event_well_links_with_faults_20km.csv

================================================================================
PROCESSING: event_well_links_with_faults_20km.csv (radius: 20 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_20km.csv) … done in 0.5s

🔎  Auto-detecting required columns:
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤20 km

🕵️  Missing-value summary:
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤20 km               : 0 NA (0.0%)
Dropped 0 rows missing treatment or outcome (0.0%)
✅  Rows after cleaning: 342463

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2

⏳  Estimating total causal effect … done in 0.1s

📈  TOTAL causal effect (ΔMagnitude per extra BBL)
    DoWhy point estimate : +4.17e-06
    Statsmodels p-value  : 0.00e+00

🔄  Running mediation analysis...
Path a (W → P)  : +0.01101 (p=0)
Path b (P → S)  : +0.0004167 (p=0)
Total effect    : +4.17e-06 (p=0)
Direct effect   : -4.159e-07 (p=2.71e-05)
Indirect effect : +4.586e-06
Proportion mediated: 110.0%

⏳  Running refutation checks … done in 14.5s

🔍  Refutation checks (effect should stay similar)
    Placebo : +3.655e-09
    Subset  : +4.182e-06

⏳  Training predictive sanity-check model … done in 0.2s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.8239
    R²   : 0.1861

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 20 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +4.17e-06
Direct effect (W → S)           : -4.159e-07
Indirect effect (W → P → S)     : +4.586e-06
Percentage mediated by pressure : 110.0%
─────────────────────────────────────────────────────

✅ Results saved to causal_analysis_results_by_radius.csv

================================================================================
COMPARATIVE SUMMARY ACROSS RADII
================================================================================

Effect Estimates by Radius:
 radius  n_rows  total_effect  direct_effect  indirect_effect  proportion_mediated
      1    1177      +0.00001       -0.00000         +0.00001           +152.32155
      2    4778      +0.00002       +0.00000         +0.00002            +84.03183
      3   11649      +0.00003       +0.00001         +0.00002            +62.51960
      4   20292      +0.00003       +0.00002         +0.00002            +48.16800
      5   30460      +0.00002       +0.00001         +0.00002            +63.40679
      6   42185      +0.00001       +0.00000         +0.00001            +79.33445
      7   55955      +0.00001       +0.00000         +0.00001            +78.28252
      8   72116      +0.00001       +0.00000         +0.00001            +94.90366
      9   90728      +0.00001       +0.00000         +0.00001            +95.70775
     10  110014      +0.00001       +0.00000         +0.00001            +91.86475
     11  130215      +0.00001       +0.00000         +0.00001            +96.91805
     12  150203      +0.00001       -0.00000         +0.00001           +106.56419
     13  170893      +0.00000       -0.00000         +0.00001           +110.25143
     14  192249      +0.00000       -0.00000         +0.00001           +105.79421
     15  215258      +0.00000       -0.00000         +0.00000           +107.72407
     16  238280      +0.00000       -0.00000         +0.00000           +108.18856
     17  263078      +0.00000       -0.00000         +0.00000           +108.70528
     18  290036      +0.00000       -0.00000         +0.00000           +111.21807
     19  316778      +0.00000       -0.00000         +0.00000           +109.73942
     20  342463      +0.00000       -0.00000         +0.00000           +109.97253

Strongest total effect found at 4.0km radius: 0.00003
Most mediation by pressure found at 1.0km radius: 152.3%

================================================================================
Analysis complete! Total runtime: 142.8 seconds
================================================================================

2025-06-04 12:08:36,127 - INFO - ✓ Completed dowhy_simple_all.py in 144.95 seconds

2025-06-04 12:08:36,127 - INFO - 
################################################################################
2025-06-04 12:08:36,127 - INFO - # STEP 6: MULTI-RADIUS EVENT-LEVEL CAUSAL ANALYSIS
2025-06-04 12:08:36,127 - INFO - ################################################################################

2025-06-04 12:08:36,127 - INFO - ======================================================================
2025-06-04 12:08:36,127 - INFO - Running: dowhy_simple_all_aggregate.py
2025-06-04 12:08:36,127 - INFO - Purpose: Event-level aggregated causal analysis
2025-06-04 12:08:36,127 - INFO - ======================================================================
2025-06-04 12:09:13,942 - INFO - Output:

================================================================================
BATCH EVENT-LEVEL CAUSAL ANALYSIS ACROSS RADII
================================================================================

Processing file 1 of 20: event_well_links_with_faults_1km.csv

================================================================================
PROCESSING: event_well_links_with_faults_1km.csv (radius: 1 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_1km.csv) … done in 0.0s

🔎  Auto-detecting required columns:
    E  ←  EventID
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤1 km

🕵️  Missing-value summary (raw rows):
   EventID                             : 0 NA (0.0%)
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤1 km                : 0 NA (0.0%)
Dropped 0 events missing treatment or outcome (0.0% if any)
✅  Events after aggregation & cleaning: 1058

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2, well_count

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL within 1 km)
    DoWhy point estimate : +3.116e-06
    Statsmodels p-value  : 0.0165

🔄  Running mediation analysis...
Path a (W → P)  : +0.01859 (p=3.13e-31)
Path b (P → S)  : +0.0003564 (p=2.57e-14)
Total effect    : +5.72e-06 (p=0.0165)
Direct effect   : -9.059e-07 (p=0.714)
Indirect effect : +6.626e-06
Proportion mediated: 115.8%

⏳  Running refutation checks … done in 0.8s

🔍  Refutation checks (effect should stay similar)
    Placebo : -3.969e-07
    Subset  : +4.47e-06

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.8120
    R²   : 0.1788

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 1 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +5.72e-06
Direct effect (W → S)           : -9.059e-07
Indirect effect (W → P → S)     : +6.626e-06
Percentage mediated by pressure : 115.8%
─────────────────────────────────────────────────────

Processing file 2 of 20: event_well_links_with_faults_2km.csv

================================================================================
PROCESSING: event_well_links_with_faults_2km.csv (radius: 2 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_2km.csv) … done in 0.0s

🔎  Auto-detecting required columns:
    E  ←  EventID
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤2 km

🕵️  Missing-value summary (raw rows):
   EventID                             : 0 NA (0.0%)
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤2 km                : 0 NA (0.0%)
Dropped 0 events missing treatment or outcome (0.0% if any)
✅  Events after aggregation & cleaning: 3162

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2, well_count

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL within 2 km)
    DoWhy point estimate : +1.815e-05
    Statsmodels p-value  : 1.78e-22

🔄  Running mediation analysis...
Path a (W → P)  : +0.02914 (p=1.57e-157)
Path b (P → S)  : +0.0004947 (p=3.4e-60)
Total effect    : +1.753e-05 (p=1.78e-22)
Direct effect   : +3.115e-06 (p=0.104)
Indirect effect : +1.442e-05
Proportion mediated: 82.2%

⏳  Running refutation checks … done in 1.5s

🔍  Refutation checks (effect should stay similar)
    Placebo : +1.946e-07
    Subset  : +1.861e-05

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.7787
    R²   : 0.2934

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 2 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +1.753e-05
Direct effect (W → S)           : +3.115e-06
Indirect effect (W → P → S)     : +1.442e-05
Percentage mediated by pressure : 82.2%
─────────────────────────────────────────────────────

Processing file 3 of 20: event_well_links_with_faults_3km.csv

================================================================================
PROCESSING: event_well_links_with_faults_3km.csv (radius: 3 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_3km.csv) … done in 0.0s

🔎  Auto-detecting required columns:
    E  ←  EventID
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤3 km

🕵️  Missing-value summary (raw rows):
   EventID                             : 0 NA (0.0%)
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤3 km                : 0 NA (0.0%)
Dropped 0 events missing treatment or outcome (0.0% if any)
✅  Events after aggregation & cleaning: 4921

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2, well_count

⏳  Estimating total causal effect … done in 0.3s

📈  TOTAL causal effect (ΔMagnitude per extra BBL within 3 km)
    DoWhy point estimate : +2.516e-05
    Statsmodels p-value  : 1.6e-71

🔄  Running mediation analysis...
Path a (W → P)  : +0.02605 (p=7.53e-291)
Path b (P → S)  : +0.000386 (p=9.5e-55)
Total effect    : +2.132e-05 (p=1.6e-71)
Direct effect   : +1.126e-05 (p=1.07e-17)
Indirect effect : +1.006e-05
Proportion mediated: 47.2%

⏳  Running refutation checks … done in 1.4s

🔍  Refutation checks (effect should stay similar)
    Placebo : -1.006e-07
    Subset  : +2.535e-05

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.7435
    R²   : 0.3620

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 3 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +2.132e-05
Direct effect (W → S)           : +1.126e-05
Indirect effect (W → P → S)     : +1.006e-05
Percentage mediated by pressure : 47.2%
─────────────────────────────────────────────────────

Processing file 4 of 20: event_well_links_with_faults_4km.csv

================================================================================
PROCESSING: event_well_links_with_faults_4km.csv (radius: 4 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_4km.csv) … done in 0.0s

🔎  Auto-detecting required columns:
    E  ←  EventID
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤4 km

🕵️  Missing-value summary (raw rows):
   EventID                             : 0 NA (0.0%)
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤4 km                : 0 NA (0.0%)
Dropped 0 events missing treatment or outcome (0.0% if any)
✅  Events after aggregation & cleaning: 6192

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2, well_count

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL within 4 km)
    DoWhy point estimate : +2.075e-05
    Statsmodels p-value  : 2.2e-97

🔄  Running mediation analysis...
Path a (W → P)  : +0.01979 (p=0)
Path b (P → S)  : +0.0003776 (p=1.26e-70)
Total effect    : +1.724e-05 (p=2.2e-97)
Direct effect   : +9.765e-06 (p=1.04e-27)
Indirect effect : +7.471e-06
Proportion mediated: 43.3%

⏳  Running refutation checks … done in 1.5s

🔍  Refutation checks (effect should stay similar)
    Placebo : -7.334e-08
    Subset  : +2.067e-05

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.6560
    R²   : 0.4966

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 4 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +1.724e-05
Direct effect (W → S)           : +9.765e-06
Indirect effect (W → P → S)     : +7.471e-06
Percentage mediated by pressure : 43.3%
─────────────────────────────────────────────────────

Processing file 5 of 20: event_well_links_with_faults_5km.csv

================================================================================
PROCESSING: event_well_links_with_faults_5km.csv (radius: 5 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_5km.csv) … done in 0.0s

🔎  Auto-detecting required columns:
    E  ←  EventID
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤5 km

🕵️  Missing-value summary (raw rows):
   EventID                             : 0 NA (0.0%)
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤5 km                : 0 NA (0.0%)
Dropped 0 events missing treatment or outcome (0.0% if any)
✅  Events after aggregation & cleaning: 7102

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2, well_count

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL within 5 km)
    DoWhy point estimate : +1.473e-05
    Statsmodels p-value  : 1.23e-88

🔄  Running mediation analysis...
Path a (W → P)  : +0.01334 (p=0)
Path b (P → S)  : +0.0004894 (p=5.2e-122)
Total effect    : +1.154e-05 (p=1.23e-88)
Direct effect   : +5.014e-06 (p=3.16e-16)
Indirect effect : +6.529e-06
Proportion mediated: 56.6%

⏳  Running refutation checks … done in 1.6s

🔍  Refutation checks (effect should stay similar)
    Placebo : +5.543e-08
    Subset  : +1.483e-05

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.6583
    R²   : 0.5085

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 5 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +1.154e-05
Direct effect (W → S)           : +5.014e-06
Indirect effect (W → P → S)     : +6.529e-06
Percentage mediated by pressure : 56.6%
─────────────────────────────────────────────────────

Processing file 6 of 20: event_well_links_with_faults_6km.csv

================================================================================
PROCESSING: event_well_links_with_faults_6km.csv (radius: 6 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_6km.csv) … done in 0.1s

🔎  Auto-detecting required columns:
    E  ←  EventID
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤6 km

🕵️  Missing-value summary (raw rows):
   EventID                             : 0 NA (0.0%)
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤6 km                : 0 NA (0.0%)
Dropped 0 events missing treatment or outcome (0.0% if any)
✅  Events after aggregation & cleaning: 7943

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2, well_count

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL within 6 km)
    DoWhy point estimate : +8.998e-06
    Statsmodels p-value  : 2.29e-53

🔄  Running mediation analysis...
Path a (W → P)  : +0.007543 (p=7.37e-264)
Path b (P → S)  : +0.0005628 (p=1.36e-177)
Total effect    : +5.865e-06 (p=2.29e-53)
Direct effect   : +1.62e-06 (p=3.04e-05)
Indirect effect : +4.245e-06
Proportion mediated: 72.4%

⏳  Running refutation checks … done in 1.5s

🔍  Refutation checks (effect should stay similar)
    Placebo : -5.269e-08
    Subset  : +9.09e-06

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.6475
    R²   : 0.5213

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 6 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +5.865e-06
Direct effect (W → S)           : +1.62e-06
Indirect effect (W → P → S)     : +4.245e-06
Percentage mediated by pressure : 72.4%
─────────────────────────────────────────────────────

Processing file 7 of 20: event_well_links_with_faults_7km.csv

================================================================================
PROCESSING: event_well_links_with_faults_7km.csv (radius: 7 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_7km.csv) … done in 0.1s

🔎  Auto-detecting required columns:
    E  ←  EventID
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤7 km

🕵️  Missing-value summary (raw rows):
   EventID                             : 0 NA (0.0%)
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤7 km                : 0 NA (0.0%)
Dropped 0 events missing treatment or outcome (0.0% if any)
✅  Events after aggregation & cleaning: 8653

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2, well_count

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL within 7 km)
    DoWhy point estimate : +8.426e-06
    Statsmodels p-value  : 7.46e-59

🔄  Running mediation analysis...
Path a (W → P)  : +0.006496 (p=0)
Path b (P → S)  : +0.000572 (p=1.69e-182)
Total effect    : +4.951e-06 (p=7.46e-59)
Direct effect   : +1.235e-06 (p=9.19e-05)
Indirect effect : +3.716e-06
Proportion mediated: 75.0%

⏳  Running refutation checks … done in 1.5s

🔍  Refutation checks (effect should stay similar)
    Placebo : +4.297e-08
    Subset  : +8.358e-06

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.6332
    R²   : 0.5422

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 7 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +4.951e-06
Direct effect (W → S)           : +1.235e-06
Indirect effect (W → P → S)     : +3.716e-06
Percentage mediated by pressure : 75.0%
─────────────────────────────────────────────────────

Processing file 8 of 20: event_well_links_with_faults_8km.csv

================================================================================
PROCESSING: event_well_links_with_faults_8km.csv (radius: 8 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_8km.csv) … done in 0.1s

🔎  Auto-detecting required columns:
    E  ←  EventID
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤8 km

🕵️  Missing-value summary (raw rows):
   EventID                             : 0 NA (0.0%)
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤8 km                : 0 NA (0.0%)
Dropped 0 events missing treatment or outcome (0.0% if any)
✅  Events after aggregation & cleaning: 9231

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2, well_count

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL within 8 km)
    DoWhy point estimate : +4.718e-06
    Statsmodels p-value  : 1.76e-26

🔄  Running mediation analysis...
Path a (W → P)  : +0.003422 (p=2.66e-223)
Path b (P → S)  : +0.0005775 (p=7.97e-192)
Total effect    : +2.142e-06 (p=1.76e-26)
Direct effect   : +1.657e-07 (p=0.412)
Indirect effect : +1.976e-06
Proportion mediated: 92.3%

⏳  Running refutation checks … done in 1.8s

🔍  Refutation checks (effect should stay similar)
    Placebo : +2.179e-08
    Subset  : +4.771e-06

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.6313
    R²   : 0.5267

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 8 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +2.142e-06
Direct effect (W → S)           : +1.657e-07
Indirect effect (W → P → S)     : +1.976e-06
Percentage mediated by pressure : 92.3%
─────────────────────────────────────────────────────

Processing file 9 of 20: event_well_links_with_faults_9km.csv

================================================================================
PROCESSING: event_well_links_with_faults_9km.csv (radius: 9 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_9km.csv) … done in 0.1s

🔎  Auto-detecting required columns:
    E  ←  EventID
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤9 km

🕵️  Missing-value summary (raw rows):
   EventID                             : 0 NA (0.0%)
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤9 km                : 0 NA (0.0%)
Dropped 0 events missing treatment or outcome (0.0% if any)
✅  Events after aggregation & cleaning: 9658

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2, well_count

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL within 9 km)
    DoWhy point estimate : +4.189e-06
    Statsmodels p-value  : 8.05e-27

🔄  Running mediation analysis...
Path a (W → P)  : +0.003036 (p=3.46e-247)
Path b (P → S)  : +0.0005738 (p=1.35e-190)
Total effect    : +1.848e-06 (p=8.05e-27)
Direct effect   : +1.059e-07 (p=0.543)
Indirect effect : +1.742e-06
Proportion mediated: 94.3%

⏳  Running refutation checks … done in 1.8s

🔍  Refutation checks (effect should stay similar)
    Placebo : -5.29e-09
    Subset  : +4.228e-06

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.6283
    R²   : 0.5029

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 9 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +1.848e-06
Direct effect (W → S)           : +1.059e-07
Indirect effect (W → P → S)     : +1.742e-06
Percentage mediated by pressure : 94.3%
─────────────────────────────────────────────────────

Processing file 10 of 20: event_well_links_with_faults_10km.csv

================================================================================
PROCESSING: event_well_links_with_faults_10km.csv (radius: 10 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_10km.csv) … done in 0.1s

🔎  Auto-detecting required columns:
    E  ←  EventID
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤10 km

🕵️  Missing-value summary (raw rows):
   EventID                             : 0 NA (0.0%)
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤10 km               : 0 NA (0.0%)
Dropped 0 events missing treatment or outcome (0.0% if any)
✅  Events after aggregation & cleaning: 9928

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2, well_count

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL within 10 km)
    DoWhy point estimate : +4.009e-06
    Statsmodels p-value  : 2.33e-31

🔄  Running mediation analysis...
Path a (W → P)  : +0.002884 (p=1.22e-283)
Path b (P → S)  : +0.0005967 (p=5.79e-198)
Total effect    : +1.835e-06 (p=2.33e-31)
Direct effect   : +1.144e-07 (p=0.475)
Indirect effect : +1.721e-06
Proportion mediated: 93.8%

⏳  Running refutation checks … done in 1.7s

🔍  Refutation checks (effect should stay similar)
    Placebo : -6.477e-09
    Subset  : +4.036e-06

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.6451
    R²   : 0.5024

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 10 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +1.835e-06
Direct effect (W → S)           : +1.144e-07
Indirect effect (W → P → S)     : +1.721e-06
Percentage mediated by pressure : 93.8%
─────────────────────────────────────────────────────

Processing file 11 of 20: event_well_links_with_faults_11km.csv

================================================================================
PROCESSING: event_well_links_with_faults_11km.csv (radius: 11 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_11km.csv) … done in 0.1s

🔎  Auto-detecting required columns:
    E  ←  EventID
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤11 km

🕵️  Missing-value summary (raw rows):
   EventID                             : 0 NA (0.0%)
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤11 km               : 0 NA (0.0%)
Dropped 0 events missing treatment or outcome (0.0% if any)
✅  Events after aggregation & cleaning: 10079

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2, well_count

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL within 11 km)
    DoWhy point estimate : +3.525e-06
    Statsmodels p-value  : 2.05e-30

🔄  Running mediation analysis...
Path a (W → P)  : +0.002438 (p=7.77e-261)
Path b (P → S)  : +0.000632 (p=2.59e-216)
Total effect    : +1.633e-06 (p=2.05e-30)
Direct effect   : +9.195e-08 (p=0.521)
Indirect effect : +1.541e-06
Proportion mediated: 94.4%

⏳  Running refutation checks … done in 1.4s

🔍  Refutation checks (effect should stay similar)
    Placebo : -1.025e-08
    Subset  : +3.509e-06

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.6675
    R²   : 0.4658

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 11 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +1.633e-06
Direct effect (W → S)           : +9.195e-08
Indirect effect (W → P → S)     : +1.541e-06
Percentage mediated by pressure : 94.4%
─────────────────────────────────────────────────────

Processing file 12 of 20: event_well_links_with_faults_12km.csv

================================================================================
PROCESSING: event_well_links_with_faults_12km.csv (radius: 12 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_12km.csv) … done in 0.2s

🔎  Auto-detecting required columns:
    E  ←  EventID
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤12 km

🕵️  Missing-value summary (raw rows):
   EventID                             : 0 NA (0.0%)
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤12 km               : 0 NA (0.0%)
Dropped 0 events missing treatment or outcome (0.0% if any)
✅  Events after aggregation & cleaning: 10179

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2, well_count

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL within 12 km)
    DoWhy point estimate : +2.89e-06
    Statsmodels p-value  : 1.09e-23

🔄  Running mediation analysis...
Path a (W → P)  : +0.00195 (p=1.44e-215)
Path b (P → S)  : +0.0006805 (p=3.03e-250)
Total effect    : +1.276e-06 (p=1.09e-23)
Direct effect   : -5.123e-08 (p=0.684)
Indirect effect : +1.327e-06
Proportion mediated: 104.0%

⏳  Running refutation checks … done in 1.5s

🔍  Refutation checks (effect should stay similar)
    Placebo : -2.092e-08
    Subset  : +2.901e-06

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.6647
    R²   : 0.4598

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 12 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +1.276e-06
Direct effect (W → S)           : -5.123e-08
Indirect effect (W → P → S)     : +1.327e-06
Percentage mediated by pressure : 104.0%
─────────────────────────────────────────────────────

Processing file 13 of 20: event_well_links_with_faults_13km.csv

================================================================================
PROCESSING: event_well_links_with_faults_13km.csv (radius: 13 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_13km.csv) … done in 0.2s

🔎  Auto-detecting required columns:
    E  ←  EventID
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤13 km

🕵️  Missing-value summary (raw rows):
   EventID                             : 0 NA (0.0%)
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤13 km               : 0 NA (0.0%)
Dropped 0 events missing treatment or outcome (0.0% if any)
✅  Events after aggregation & cleaning: 10286

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2, well_count

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL within 13 km)
    DoWhy point estimate : +2.238e-06
    Statsmodels p-value  : 3.15e-20

🔄  Running mediation analysis...
Path a (W → P)  : +0.001416 (p=1.51e-161)
Path b (P → S)  : +0.0007365 (p=1.37e-296)
Total effect    : +9.934e-07 (p=3.15e-20)
Direct effect   : -4.919e-08 (p=0.638)
Indirect effect : +1.043e-06
Proportion mediated: 105.0%

⏳  Running refutation checks … done in 1.5s

🔍  Refutation checks (effect should stay similar)
    Placebo : +4.933e-09
    Subset  : +2.24e-06

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.6774
    R²   : 0.4666

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 13 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +9.934e-07
Direct effect (W → S)           : -4.919e-08
Indirect effect (W → P → S)     : +1.043e-06
Percentage mediated by pressure : 105.0%
─────────────────────────────────────────────────────

Processing file 14 of 20: event_well_links_with_faults_14km.csv

================================================================================
PROCESSING: event_well_links_with_faults_14km.csv (radius: 14 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_14km.csv) … done in 0.2s

🔎  Auto-detecting required columns:
    E  ←  EventID
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤14 km

🕵️  Missing-value summary (raw rows):
   EventID                             : 0 NA (0.0%)
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤14 km               : 0 NA (0.0%)
Dropped 0 events missing treatment or outcome (0.0% if any)
✅  Events after aggregation & cleaning: 10380

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2, well_count

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL within 14 km)
    DoWhy point estimate : +2.173e-06
    Statsmodels p-value  : 4.79e-26

🔄  Running mediation analysis...
Path a (W → P)  : +0.001298 (p=2.78e-162)
Path b (P → S)  : +0.0008186 (p=0)
Total effect    : +1.07e-06 (p=4.79e-26)
Direct effect   : +7.183e-09 (p=0.941)
Indirect effect : +1.063e-06
Proportion mediated: 99.3%

⏳  Running refutation checks … done in 1.5s

🔍  Refutation checks (effect should stay similar)
    Placebo : +6.942e-09
    Subset  : +2.186e-06

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.6570
    R²   : 0.4644

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 14 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +1.07e-06
Direct effect (W → S)           : +7.183e-09
Indirect effect (W → P → S)     : +1.063e-06
Percentage mediated by pressure : 99.3%
─────────────────────────────────────────────────────

Processing file 15 of 20: event_well_links_with_faults_15km.csv

================================================================================
PROCESSING: event_well_links_with_faults_15km.csv (radius: 15 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_15km.csv) … done in 0.3s

🔎  Auto-detecting required columns:
    E  ←  EventID
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤15 km

🕵️  Missing-value summary (raw rows):
   EventID                             : 0 NA (0.0%)
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤15 km               : 0 NA (0.0%)
Dropped 0 events missing treatment or outcome (0.0% if any)
✅  Events after aggregation & cleaning: 10429

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2, well_count

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL within 15 km)
    DoWhy point estimate : +1.949e-06
    Statsmodels p-value  : 4.2e-28

🔄  Running mediation analysis...
Path a (W → P)  : +0.001117 (p=3.69e-155)
Path b (P → S)  : +0.0008866 (p=0)
Total effect    : +1.008e-06 (p=4.2e-28)
Direct effect   : +1.768e-08 (p=0.838)
Indirect effect : +9.903e-07
Proportion mediated: 98.2%

⏳  Running refutation checks … done in 1.7s

🔍  Refutation checks (effect should stay similar)
    Placebo : -3.351e-09
    Subset  : +1.948e-06

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.6713
    R²   : 0.4518

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 15 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +1.008e-06
Direct effect (W → S)           : +1.768e-08
Indirect effect (W → P → S)     : +9.903e-07
Percentage mediated by pressure : 98.2%
─────────────────────────────────────────────────────

Processing file 16 of 20: event_well_links_with_faults_16km.csv

================================================================================
PROCESSING: event_well_links_with_faults_16km.csv (radius: 16 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_16km.csv) … done in 0.3s

🔎  Auto-detecting required columns:
    E  ←  EventID
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤16 km

🕵️  Missing-value summary (raw rows):
   EventID                             : 0 NA (0.0%)
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤16 km               : 0 NA (0.0%)
Dropped 0 events missing treatment or outcome (0.0% if any)
✅  Events after aggregation & cleaning: 10488

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2, well_count

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL within 16 km)
    DoWhy point estimate : +1.739e-06
    Statsmodels p-value  : 1.92e-28

🔄  Running mediation analysis...
Path a (W → P)  : +0.000969 (p=1.79e-146)
Path b (P → S)  : +0.0009339 (p=0)
Total effect    : +9.294e-07 (p=1.92e-28)
Direct effect   : +2.443e-08 (p=0.756)
Indirect effect : +9.05e-07
Proportion mediated: 97.4%

⏳  Running refutation checks … done in 1.6s

🔍  Refutation checks (effect should stay similar)
    Placebo : -3.925e-09
    Subset  : +1.749e-06

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.6778
    R²   : 0.4533

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 16 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +9.294e-07
Direct effect (W → S)           : +2.443e-08
Indirect effect (W → P → S)     : +9.05e-07
Percentage mediated by pressure : 97.4%
─────────────────────────────────────────────────────

Processing file 17 of 20: event_well_links_with_faults_17km.csv

================================================================================
PROCESSING: event_well_links_with_faults_17km.csv (radius: 17 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_17km.csv) … done in 0.3s

🔎  Auto-detecting required columns:
    E  ←  EventID
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤17 km

🕵️  Missing-value summary (raw rows):
   EventID                             : 0 NA (0.0%)
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤17 km               : 0 NA (0.0%)
Dropped 0 events missing treatment or outcome (0.0% if any)
✅  Events after aggregation & cleaning: 10527

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2, well_count

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL within 17 km)
    DoWhy point estimate : +1.685e-06
    Statsmodels p-value  : 9.41e-37

🔄  Running mediation analysis...
Path a (W → P)  : +0.0009356 (p=1.35e-163)
Path b (P → S)  : +0.0009826 (p=0)
Total effect    : +1.001e-06 (p=9.41e-37)
Direct effect   : +8.158e-08 (p=0.27)
Indirect effect : +9.193e-07
Proportion mediated: 91.8%

⏳  Running refutation checks … done in 1.6s

🔍  Refutation checks (effect should stay similar)
    Placebo : -1.161e-09
    Subset  : +1.675e-06

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.6987
    R²   : 0.4059

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 17 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +1.001e-06
Direct effect (W → S)           : +8.158e-08
Indirect effect (W → P → S)     : +9.193e-07
Percentage mediated by pressure : 91.8%
─────────────────────────────────────────────────────

Processing file 18 of 20: event_well_links_with_faults_18km.csv

================================================================================
PROCESSING: event_well_links_with_faults_18km.csv (radius: 18 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_18km.csv) … done in 0.4s

🔎  Auto-detecting required columns:
    E  ←  EventID
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤18 km

🕵️  Missing-value summary (raw rows):
   EventID                             : 0 NA (0.0%)
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤18 km               : 0 NA (0.0%)
Dropped 0 events missing treatment or outcome (0.0% if any)
✅  Events after aggregation & cleaning: 10565

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2, well_count

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL within 18 km)
    DoWhy point estimate : +1.545e-06
    Statsmodels p-value  : 9.9e-43

🔄  Running mediation analysis...
Path a (W → P)  : +0.0008531 (p=8.11e-168)
Path b (P → S)  : +0.001009 (p=0)
Total effect    : +9.928e-07 (p=9.9e-43)
Direct effect   : +1.321e-07 (p=0.0511)
Indirect effect : +8.607e-07
Proportion mediated: 86.7%

⏳  Running refutation checks … done in 1.6s

🔍  Refutation checks (effect should stay similar)
    Placebo : +3.149e-09
    Subset  : +1.545e-06

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.6888
    R²   : 0.4318

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 18 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +9.928e-07
Direct effect (W → S)           : +1.321e-07
Indirect effect (W → P → S)     : +8.607e-07
Percentage mediated by pressure : 86.7%
─────────────────────────────────────────────────────

Processing file 19 of 20: event_well_links_with_faults_19km.csv

================================================================================
PROCESSING: event_well_links_with_faults_19km.csv (radius: 19 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_19km.csv) … done in 0.4s

🔎  Auto-detecting required columns:
    E  ←  EventID
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤19 km

🕵️  Missing-value summary (raw rows):
   EventID                             : 0 NA (0.0%)
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤19 km               : 0 NA (0.0%)
Dropped 0 events missing treatment or outcome (0.0% if any)
✅  Events after aggregation & cleaning: 10606

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2, well_count

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL within 19 km)
    DoWhy point estimate : +1.514e-06
    Statsmodels p-value  : 3.27e-52

🔄  Running mediation analysis...
Path a (W → P)  : +0.0008613 (p=1.23e-187)
Path b (P → S)  : +0.001019 (p=0)
Total effect    : +1.048e-06 (p=3.27e-52)
Direct effect   : +1.707e-07 (p=0.0081)
Indirect effect : +8.774e-07
Proportion mediated: 83.7%

⏳  Running refutation checks … done in 1.9s

🔍  Refutation checks (effect should stay similar)
    Placebo : +1.155e-08
    Subset  : +1.527e-06

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.6984
    R²   : 0.4285

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 19 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +1.048e-06
Direct effect (W → S)           : +1.707e-07
Indirect effect (W → P → S)     : +8.774e-07
Percentage mediated by pressure : 83.7%
─────────────────────────────────────────────────────

Processing file 20 of 20: event_well_links_with_faults_20km.csv

================================================================================
PROCESSING: event_well_links_with_faults_20km.csv (radius: 20 km)
================================================================================

⏳  Loading CSV (event_well_links_with_faults_20km.csv) … done in 0.4s

🔎  Auto-detecting required columns:
    E  ←  EventID
    W  ←  Volume Injected (BBLs)
    P  ←  Injection Pressure Average PSIG
    S  ←  Local Magnitude
   G1  ←  Nearest Fault Dist (km)
   G2  ←  Fault Segments ≤20 km

🕵️  Missing-value summary (raw rows):
   EventID                             : 0 NA (0.0%)
   Volume Injected (BBLs)              : 0 NA (0.0%)
   Injection Pressure Average PSIG     : 0 NA (0.0%)
   Local Magnitude                     : 0 NA (0.0%)
   Nearest Fault Dist (km)             : 0 NA (0.0%)
   Fault Segments ≤20 km               : 0 NA (0.0%)
Dropped 0 events missing treatment or outcome (0.0% if any)
✅  Events after aggregation & cleaning: 10635

⏳  Building DoWhy model … done in 0.0s
📝  Back-door controls: G1, G2, well_count

⏳  Estimating total causal effect … done in 0.0s

📈  TOTAL causal effect (ΔMagnitude per extra BBL within 20 km)
    DoWhy point estimate : +1.458e-06
    Statsmodels p-value  : 8.69e-61

🔄  Running mediation analysis...
Path a (W → P)  : +0.0008553 (p=5.76e-202)
Path b (P → S)  : +0.001005 (p=0)
Total effect    : +1.071e-06 (p=8.69e-61)
Direct effect   : +2.115e-07 (p=0.000534)
Indirect effect : +8.599e-07
Proportion mediated: 80.3%

⏳  Running refutation checks … done in 1.6s

🔍  Refutation checks (effect should stay similar)
    Placebo : +6.985e-09
    Subset  : +1.459e-06

⏳  Training predictive sanity-check model … done in 0.0s

⚙️   Prediction metrics (non-causal sanity check)
    RMSE : 0.6820
    R²   : 0.4306

🖼️   graphviz or pydot not installed → DAG image skipped

📋  SUMMARY OF MEDIATION ANALYSIS (RADIUS: 20 KM)
─────────────────────────────────────────────────────
Total effect (W → S)            : +1.071e-06
Direct effect (W → S)           : +2.115e-07
Indirect effect (W → P → S)     : +8.599e-07
Percentage mediated by pressure : 80.3%
─────────────────────────────────────────────────────

📈  PoE curves written → earthquake_probability_curves_20km.png
📑  Data table written → earthquake_probability_curves_20km.csv

✅ Results saved to event_level_causal_analysis_by_radius.csv

================================================================================
COMPARATIVE SUMMARY ACROSS RADII
================================================================================

Effect Estimates by Radius (Event Level):
 radius  n_events  avg_well_count  total_effect  direct_effect  indirect_effect  proportion_mediated
      1      1058        +1.11248      +0.00001       -0.00000         +0.00001           +115.83697
      2      3162        +1.51107      +0.00002       +0.00000         +0.00001            +82.22834
      3      4921        +2.36720      +0.00002       +0.00001         +0.00001            +47.17311
      4      6192        +3.27713      +0.00002       +0.00001         +0.00001            +43.34378
      5      7102        +4.28893      +0.00001       +0.00001         +0.00001            +56.56110
      6      7943        +5.31097      +0.00001       +0.00000         +0.00000            +72.38557
      7      8653        +6.46654      +0.00000       +0.00000         +0.00000            +75.04736
      8      9231        +7.81237      +0.00000       +0.00000         +0.00000            +92.26379
      9      9658        +9.39408      +0.00000       +0.00000         +0.00000            +94.27133
     10      9928       +11.08118      +0.00000       +0.00000         +0.00000            +93.76481
     11     10079       +12.91944      +0.00000       +0.00000         +0.00000            +94.36817
     12     10179       +14.75616      +0.00000       -0.00000         +0.00000           +104.01537
     13     10286       +16.61414      +0.00000       -0.00000         +0.00000           +104.95163
     14     10380       +18.52110      +0.00000       +0.00000         +0.00000            +99.32856
     15     10429       +20.64033      +0.00000       +0.00000         +0.00000            +98.24639
     16     10488       +22.71930      +0.00000       +0.00000         +0.00000            +97.37172
     17     10527       +24.99079      +0.00000       +0.00000         +0.00000            +91.84954
     18     10565       +27.45253      +0.00000       +0.00000         +0.00000            +86.69191
     19     10606       +29.86781      +0.00000       +0.00000         +0.00000            +83.71206
     20     10635       +32.20150      +0.00000       +0.00000         +0.00000            +80.25524

Strongest total effect at event level: 3.0km radius: 0.00002
Most mediation by pressure at event level: 1.0km radius: 115.8%

Total analysis runtime: 0m 36s

Amplification factors compared to 20km radius:
  1.0km: 5.339x
  2.0km: 16.362x
  3.0km: 19.895x
  4.0km: 16.087x
  5.0km: 10.773x
  6.0km: 5.474x
  7.0km: 4.621x
  8.0km: 1.999x
  9.0km: 1.725x
  10.0km: 1.713x
  11.0km: 1.524x
  12.0km: 1.191x
  13.0km: 0.927x
  14.0km: 0.999x
  15.0km: 0.941x
  16.0km: 0.867x
  17.0km: 0.934x
  18.0km: 0.927x
  19.0km: 0.978x

================================================================================
Analysis complete!
================================================================================

2025-06-04 12:09:13,942 - INFO - ✓ Completed dowhy_simple_all_aggregate.py in 37.81 seconds

2025-06-04 12:09:13,942 - INFO - 
################################################################################
2025-06-04 12:09:13,942 - INFO - # STEP 7: ENHANCED WELL-LEVEL DOWHY ANALYSIS WITH BOOTSTRAP CI
2025-06-04 12:09:13,942 - INFO - ################################################################################

2025-06-04 12:09:13,942 - INFO - ======================================================================
2025-06-04 12:09:13,942 - INFO - Running: dowhy_ci.py
2025-06-04 12:09:13,942 - INFO - Purpose: Well-level analysis with bootstrap confidence intervals (50 iterations)
2025-06-04 12:09:13,942 - INFO - ======================================================================
2025-06-04 12:13:55,862 - INFO - Output:
Current working directory: /Users/lewismatthews/Desktop/Project Geminae/General/SensitivityCausalSWD

Looking for data files...

🎯 Found 20 event files to process:
   1.  1km - event_well_links_with_faults_1km.csv (0.2 MB)
   2.  2km - event_well_links_with_faults_2km.csv (0.8 MB)
   3.  3km - event_well_links_with_faults_3km.csv (2.0 MB)
   4.  4km - event_well_links_with_faults_4km.csv (3.5 MB)
   5.  5km - event_well_links_with_faults_5km.csv (5.2 MB)
   6.  6km - event_well_links_with_faults_6km.csv (7.2 MB)
   7.  7km - event_well_links_with_faults_7km.csv (9.5 MB)
   8.  8km - event_well_links_with_faults_8km.csv (12.3 MB)
   9.  9km - event_well_links_with_faults_9km.csv (15.4 MB)
  10. 10km - event_well_links_with_faults_10km.csv (18.6 MB)
  11. 11km - event_well_links_with_faults_11km.csv (22.0 MB)
  12. 12km - event_well_links_with_faults_12km.csv (25.4 MB)
  13. 13km - event_well_links_with_faults_13km.csv (28.9 MB)
  14. 14km - event_well_links_with_faults_14km.csv (32.5 MB)
  15. 15km - event_well_links_with_faults_15km.csv (36.4 MB)
  16. 16km - event_well_links_with_faults_16km.csv (40.4 MB)
  17. 17km - event_well_links_with_faults_17km.csv (44.5 MB)
  18. 18km - event_well_links_with_faults_18km.csv (49.1 MB)
  19. 19km - event_well_links_with_faults_19km.csv (53.6 MB)
  20. 20km - event_well_links_with_faults_20km.csv (57.9 MB)

================================================================================
BATCH DOWHY MEDIATION ANALYSIS WITH BOOTSTRAP CI
Started: 2025-06-04 12:09:15
================================================================================

[1/20] Processing event_well_links_with_faults_1km.csv...

============================================================
PROCESSING: event_well_links_with_faults_1km.csv
============================================================
✅ Loaded 1,177 rows
✅ Clean data: 1,177 rows (dropped 0)
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy analysis complete
   Total effect: +6.472e-06 (p=2.074e-02)
   Direct effect: -3.386e-06 (p=2.512e-01)
   Indirect effect: +9.858e-06
   Proportion mediated: 152.3%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.092

[2/20] Processing event_well_links_with_faults_2km.csv...

============================================================
PROCESSING: event_well_links_with_faults_2km.csv
============================================================
✅ Loaded 4,778 rows
✅ Clean data: 4,778 rows (dropped 0)
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy analysis complete
   Total effect: +2.337e-05 (p=3.100e-30)
   Direct effect: +3.731e-06 (p=1.031e-01)
   Indirect effect: +1.964e-05
   Proportion mediated: 84.0%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.194

[3/20] Processing event_well_links_with_faults_3km.csv...

============================================================
PROCESSING: event_well_links_with_faults_3km.csv
============================================================
✅ Loaded 11,649 rows
✅ Clean data: 11,649 rows (dropped 0)
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy analysis complete
   Total effect: +3.031e-05 (p=8.458e-100)
   Direct effect: +1.136e-05 (p=9.745e-12)
   Indirect effect: +1.895e-05
   Proportion mediated: 62.5%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.180

[4/20] Processing event_well_links_with_faults_4km.csv...

============================================================
PROCESSING: event_well_links_with_faults_4km.csv
============================================================
✅ Loaded 20,292 rows
✅ Clean data: 20,292 rows (dropped 0)
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy analysis complete
   Total effect: +3.137e-05 (p=2.606e-183)
   Direct effect: +1.626e-05 (p=1.446e-37)
   Indirect effect: +1.511e-05
   Proportion mediated: 48.2%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.189

[5/20] Processing event_well_links_with_faults_5km.csv...

============================================================
PROCESSING: event_well_links_with_faults_5km.csv
============================================================
✅ Loaded 30,460 rows
✅ Clean data: 30,460 rows (dropped 0)
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy analysis complete
   Total effect: +2.456e-05 (p=1.264e-200)
   Direct effect: +8.988e-06 (p=6.401e-22)
   Indirect effect: +1.557e-05
   Proportion mediated: 63.4%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.170

[6/20] Processing event_well_links_with_faults_6km.csv...

============================================================
PROCESSING: event_well_links_with_faults_6km.csv
============================================================
✅ Loaded 42,185 rows
✅ Clean data: 42,185 rows (dropped 0)
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy analysis complete
   Total effect: +1.417e-05 (p=7.792e-146)
   Direct effect: +2.929e-06 (p=7.391e-07)
   Indirect effect: +1.124e-05
   Proportion mediated: 79.3%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.171

[7/20] Processing event_well_links_with_faults_7km.csv...

============================================================
PROCESSING: event_well_links_with_faults_7km.csv
============================================================
✅ Loaded 55,955 rows
✅ Clean data: 55,955 rows (dropped 0)
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy analysis complete
   Total effect: +1.461e-05 (p=1.616e-202)
   Direct effect: +3.173e-06 (p=9.109e-10)
   Indirect effect: +1.144e-05
   Proportion mediated: 78.3%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.171

[8/20] Processing event_well_links_with_faults_8km.csv...

============================================================
PROCESSING: event_well_links_with_faults_8km.csv
============================================================
✅ Loaded 72,116 rows
✅ Clean data: 72,116 rows (dropped 0)
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy analysis complete
   Total effect: +7.607e-06 (p=3.130e-116)
   Direct effect: +3.877e-07 (p=2.580e-01)
   Indirect effect: +7.219e-06
   Proportion mediated: 94.9%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.153

[9/20] Processing event_well_links_with_faults_9km.csv...

============================================================
PROCESSING: event_well_links_with_faults_9km.csv
============================================================
✅ Loaded 90,728 rows
✅ Clean data: 90,728 rows (dropped 0)
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy analysis complete
   Total effect: +7.969e-06 (p=1.056e-157)
   Direct effect: +3.420e-07 (p=2.665e-01)
   Indirect effect: +7.627e-06
   Proportion mediated: 95.7%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.160

[10/20] Processing event_well_links_with_faults_10km.csv...

============================================================
PROCESSING: event_well_links_with_faults_10km.csv
============================================================
✅ Loaded 110,014 rows
✅ Clean data: 110,014 rows (dropped 0)
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy analysis complete
   Total effect: +9.095e-06 (p=2.855e-234)
   Direct effect: +7.399e-07 (p=1.034e-02)
   Indirect effect: +8.355e-06
   Proportion mediated: 91.9%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.156

[11/20] Processing event_well_links_with_faults_11km.csv...

============================================================
PROCESSING: event_well_links_with_faults_11km.csv
============================================================
✅ Loaded 130,215 rows
✅ Clean data: 130,215 rows (dropped 0)
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy analysis complete
   Total effect: +8.176e-06 (p=9.623e-248)
   Direct effect: +2.520e-07 (p=3.131e-01)
   Indirect effect: +7.924e-06
   Proportion mediated: 96.9%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.155

[12/20] Processing event_well_links_with_faults_12km.csv...

============================================================
PROCESSING: event_well_links_with_faults_12km.csv
============================================================
✅ Loaded 150,203 rows
✅ Clean data: 150,203 rows (dropped 0)
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy analysis complete
   Total effect: +6.199e-06 (p=1.576e-203)
   Direct effect: -4.069e-07 (p=4.861e-02)
   Indirect effect: +6.606e-06
   Proportion mediated: 106.6%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.156

[13/20] Processing event_well_links_with_faults_13km.csv...

============================================================
PROCESSING: event_well_links_with_faults_13km.csv
============================================================
✅ Loaded 170,893 rows
✅ Clean data: 170,893 rows (dropped 0)
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy analysis complete
   Total effect: +4.725e-06 (p=3.666e-170)
   Direct effect: -4.844e-07 (p=4.487e-03)
   Indirect effect: +5.210e-06
   Proportion mediated: 110.3%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.162

[14/20] Processing event_well_links_with_faults_14km.csv...

============================================================
PROCESSING: event_well_links_with_faults_14km.csv
============================================================
✅ Loaded 192,249 rows
✅ Clean data: 192,249 rows (dropped 0)
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy analysis complete
   Total effect: +4.727e-06 (p=2.958e-199)
   Direct effect: -2.739e-07 (p=8.118e-02)
   Indirect effect: +5.001e-06
   Proportion mediated: 105.8%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.170

[15/20] Processing event_well_links_with_faults_15km.csv...

============================================================
PROCESSING: event_well_links_with_faults_15km.csv
============================================================
✅ Loaded 215,258 rows
✅ Clean data: 215,258 rows (dropped 0)
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy analysis complete
   Total effect: +4.464e-06 (p=2.695e-215)
   Direct effect: -3.448e-07 (p=1.527e-02)
   Indirect effect: +4.809e-06
   Proportion mediated: 107.7%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.171

[16/20] Processing event_well_links_with_faults_16km.csv...

============================================================
PROCESSING: event_well_links_with_faults_16km.csv
============================================================
✅ Loaded 238,280 rows
✅ Clean data: 238,280 rows (dropped 0)
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy analysis complete
   Total effect: +4.115e-06 (p=1.383e-224)
   Direct effect: -3.370e-07 (p=8.329e-03)
   Indirect effect: +4.452e-06
   Proportion mediated: 108.2%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.171

[17/20] Processing event_well_links_with_faults_17km.csv...

============================================================
PROCESSING: event_well_links_with_faults_17km.csv
============================================================
✅ Loaded 263,078 rows
✅ Clean data: 263,078 rows (dropped 0)
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy analysis complete
   Total effect: +4.105e-06 (p=1.276e-256)
   Direct effect: -3.573e-07 (p=2.605e-03)
   Indirect effect: +4.462e-06
   Proportion mediated: 108.7%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.178

[18/20] Processing event_well_links_with_faults_18km.csv...

============================================================
PROCESSING: event_well_links_with_faults_18km.csv
============================================================
✅ Loaded 290,036 rows
✅ Clean data: 290,036 rows (dropped 0)
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy analysis complete
   Total effect: +3.901e-06 (p=1.143e-275)
   Direct effect: -4.376e-07 (p=5.293e-05)
   Indirect effect: +4.339e-06
   Proportion mediated: 111.2%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.171

[19/20] Processing event_well_links_with_faults_19km.csv...

============================================================
PROCESSING: event_well_links_with_faults_19km.csv
============================================================
✅ Loaded 316,778 rows
✅ Clean data: 316,778 rows (dropped 0)
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy analysis complete
   Total effect: +4.087e-06 (p=0.000e+00)
   Direct effect: -3.980e-07 (p=1.220e-04)
   Indirect effect: +4.485e-06
   Proportion mediated: 109.7%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.184

[20/20] Processing event_well_links_with_faults_20km.csv...

============================================================
PROCESSING: event_well_links_with_faults_20km.csv
============================================================
✅ Loaded 342,463 rows
✅ Clean data: 342,463 rows (dropped 0)
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy analysis complete
   Total effect: +4.170e-06 (p=0.000e+00)
   Direct effect: -4.159e-07 (p=2.708e-05)
   Indirect effect: +4.586e-06
   Proportion mediated: 110.0%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.186

============================================================================================================================================
📊 COMPREHENSIVE DOWHY MEDIATION ANALYSIS SUMMARY
============================================================================================================================================

🎯 CAUSAL EFFECTS BY RADIUS:
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Radius       N  Total Effect               95% CI  Direct Effect               95% CI    Indirect  % Med Causal R²  Pred R²
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1km   1,177 +6.472e-06 [+4.12e-07,+4.06e-05]  -3.386e-06 [-5.65e-06,+2.09e-05] +9.86e-06 152.3%    0.015   0.092
   2km   4,778 +2.337e-05 [+1.56e-05,+4.38e-05]  +3.731e-06 [-7.00e-07,+1.89e-05] +1.96e-05  84.0%    0.032   0.194
   3km  11,649 +3.031e-05 [+2.21e-05,+4.12e-05]  +1.136e-05 [+5.51e-06,+2.01e-05] +1.90e-05  62.5%    0.041   0.180
   4km  20,292 +3.137e-05 [+2.59e-05,+3.68e-05]  +1.626e-05 [+9.51e-06,+2.31e-05] +1.51e-05  48.2%    0.041   0.189
   5km  30,460 +2.456e-05 [+1.92e-05,+3.11e-05]  +8.988e-06 [+4.29e-06,+1.43e-05] +1.56e-05  63.4%    0.030   0.170
   6km  42,185 +1.417e-05 [+1.07e-05,+1.97e-05]  +2.929e-06 [+1.10e-06,+6.45e-06] +1.12e-05  79.3%    0.016   0.171
   7km  55,955 +1.461e-05 [+1.09e-05,+1.98e-05]  +3.173e-06 [+1.66e-06,+5.62e-06] +1.14e-05  78.3%    0.017   0.171
   8km  72,116 +7.607e-06 [+5.62e-06,+1.09e-05]  +3.877e-07 [-3.74e-07,+1.89e-06] +7.22e-06  94.9%    0.008   0.153
   9km  90,728 +7.969e-06 [+6.47e-06,+1.02e-05]  +3.420e-07 [-3.52e-07,+1.29e-06] +7.63e-06  95.7%    0.009   0.160
  10km 110,014 +9.095e-06 [+7.17e-06,+1.19e-05]  +7.399e-07 [+6.18e-08,+1.77e-06] +8.36e-06  91.9%    0.011   0.156
  11km 130,215 +8.176e-06 [+6.30e-06,+9.78e-06]  +2.520e-07 [-3.92e-07,+9.35e-07] +7.92e-06  96.9%    0.010   0.155
  12km 150,203 +6.199e-06 [+4.86e-06,+7.23e-06]  -4.069e-07 [-8.45e-07,+4.07e-08] +6.61e-06 106.6%    0.007   0.156
  13km 170,893 +4.725e-06 [+3.79e-06,+6.05e-06]  -4.844e-07 [-8.47e-07,-5.90e-08] +5.21e-06 110.3%    0.006   0.162
  14km 192,249 +4.727e-06 [+3.89e-06,+5.57e-06]  -2.739e-07 [-5.35e-07,+1.02e-07] +5.00e-06 105.8%    0.006   0.170
  15km 215,258 +4.464e-06 [+3.61e-06,+5.30e-06]  -3.448e-07 [-6.63e-07,-3.50e-08] +4.81e-06 107.7%    0.006   0.171
  16km 238,280 +4.115e-06 [+3.50e-06,+5.18e-06]  -3.370e-07 [-5.91e-07,-1.74e-08] +4.45e-06 108.2%    0.005   0.171
  17km 263,078 +4.105e-06 [+3.52e-06,+4.93e-06]  -3.573e-07 [-5.66e-07,-7.95e-08] +4.46e-06 108.7%    0.006   0.178
  18km 290,036 +3.901e-06 [+3.14e-06,+4.74e-06]  -4.376e-07 [-6.73e-07,-1.65e-07] +4.34e-06 111.2%    0.006   0.171
  19km 316,778 +4.087e-06 [+3.51e-06,+4.79e-06]  -3.980e-07 [-6.42e-07,-1.40e-07] +4.49e-06 109.7%    0.007   0.184
  20km 342,463 +4.170e-06 [+3.60e-06,+4.72e-06]  -4.159e-07 [-6.50e-07,-1.54e-07] +4.59e-06 110.0%    0.007   0.186
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

📈 STATISTICAL SIGNIFICANCE & QUALITY METRICS:
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Radius  Total p-val  Direct p-val  Path a p-val  Path b p-val  Bootstrap    VIF
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1km 2.07e-02*   2.51e-01    1.50e-44*** 4.97e-17***   100.0%  1.77
   2km 3.10e-30*** 1.03e-01    3.19e-310*** 1.86e-62***   100.0%  2.68
   3km 8.46e-100*** 9.75e-12*** 0.00e+00*** 6.75e-93***   100.0%  2.96
   4km 2.61e-183*** 1.45e-37*** 0.00e+00*** 2.56e-105***   100.0%  3.27
   5km 1.26e-200*** 6.40e-22*** 0.00e+00*** 3.35e-217***   100.0%  3.59
   6km 7.79e-146*** 7.39e-07*** 0.00e+00*** 0.00e+00***   100.0%  3.58
   7km 1.62e-202*** 9.11e-10*** 0.00e+00*** 0.00e+00***   100.0%  3.63
   8km 3.13e-116*** 2.58e-01    0.00e+00*** 0.00e+00***   100.0%  3.62
   9km 1.06e-157*** 2.66e-01    0.00e+00*** 0.00e+00***   100.0%  3.63
  10km 2.86e-234*** 1.03e-02*   0.00e+00*** 0.00e+00***   100.0%  3.63
  11km 9.62e-248*** 3.13e-01    0.00e+00*** 0.00e+00***   100.0%  3.52
  12km 1.58e-203*** 4.86e-02*   0.00e+00*** 0.00e+00***   100.0%  3.48
  13km 3.67e-170*** 4.49e-03**  0.00e+00*** 0.00e+00***   100.0%  3.47
  14km 2.96e-199*** 8.12e-02    0.00e+00*** 0.00e+00***   100.0%  3.45
  15km 2.70e-215*** 1.53e-02*   0.00e+00*** 0.00e+00***   100.0%  3.47
  16km 1.38e-224*** 8.33e-03**  0.00e+00*** 0.00e+00***   100.0%  3.50
  17km 1.28e-256*** 2.61e-03**  0.00e+00*** 0.00e+00***   100.0%  3.57
  18km 1.14e-275*** 5.29e-05*** 0.00e+00*** 0.00e+00***   100.0%  3.64
  19km 0.00e+00*** 1.22e-04*** 0.00e+00*** 0.00e+00***   100.0%  3.72
  20km 0.00e+00*** 2.71e-05*** 0.00e+00*** 0.00e+00***   100.0%  3.78
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Significance: *** p<0.001, ** p<0.01, * p<0.05

🔍 DOWHY REFUTATION TESTS:
────────────────────────────────────────────────────────────────────────────────
Radius     Original      Placebo       Subset          Status
────────────────────────────────────────────────────────────────────────────────
   1km +6.47e-06 +4.22e-08 +8.29e-06      ⚠️ CAUTION
   2km +2.34e-05 +4.86e-08 +2.51e-05          ✅ PASS
   3km +3.03e-05 +2.66e-07 +3.03e-05          ✅ PASS
   4km +3.14e-05 -1.62e-07 +3.16e-05          ✅ PASS
   5km +2.46e-05 -4.92e-08 +2.48e-05          ✅ PASS
   6km +1.42e-05 +6.90e-08 +1.42e-05          ✅ PASS
   7km +1.46e-05 +6.28e-08 +1.46e-05          ✅ PASS
   8km +7.61e-06 -3.92e-08 +7.72e-06          ✅ PASS
   9km +7.97e-06 -2.99e-08 +8.09e-06          ✅ PASS
  10km +9.10e-06 -1.45e-08 +9.07e-06          ✅ PASS
  11km +8.18e-06 +4.18e-09 +8.15e-06          ✅ PASS
  12km +6.20e-06 +1.49e-08 +6.22e-06          ✅ PASS
  13km +4.73e-06 +9.50e-09 +4.78e-06          ✅ PASS
  14km +4.73e-06 +1.80e-08 +4.72e-06          ✅ PASS
  15km +4.46e-06 +2.10e-08 +4.47e-06          ✅ PASS
  16km +4.12e-06 +3.06e-10 +4.10e-06          ✅ PASS
  17km +4.10e-06 +7.54e-09 +4.10e-06          ✅ PASS
  18km +3.90e-06 -1.05e-08 +3.89e-06          ✅ PASS
  19km +4.09e-06 -7.68e-09 +4.10e-06          ✅ PASS
  20km +4.17e-06 -4.80e-09 +4.19e-06          ✅ PASS
────────────────────────────────────────────────────────────────────────────────

🔍 KEY INSIGHTS:
────────────────────────────────────────────────────────────
• Strongest total effect:    4km (+3.137e-05)
• Highest mediation:         1km (152.3%)
• Best causal model fit:     3km (R²=0.041)
• Best predictive fit:       2km (R²=0.194)
• Sample size range:         1,177 - 342,463 observations
• Near-field mediation:      82.1% (≤5km)
• Far-field mediation:       106.1% (≥10km)
• Average bootstrap success: 100.0%
• Average VIF:               3.40
────────────────────────────────────────────────────────────

💾 Results saved to: dowhy_mediation_analysis_20250604_121355.csv

================================================================================
Analysis completed: 2025-06-04 12:13:55
================================================================================

2025-06-04 12:13:55,863 - INFO - ✓ Completed dowhy_ci.py in 281.92 seconds

2025-06-04 12:13:55,863 - INFO - 
################################################################################
2025-06-04 12:13:55,863 - INFO - # STEP 8: ENHANCED EVENT-LEVEL DOWHY ANALYSIS WITH BOOTSTRAP CI
2025-06-04 12:13:55,863 - INFO - ################################################################################

2025-06-04 12:13:55,863 - INFO - ======================================================================
2025-06-04 12:13:55,863 - INFO - Running: dowhy_ci_aggregated.py
2025-06-04 12:13:55,863 - INFO - Purpose: Event-level analysis with bootstrap confidence intervals (50 iterations)
2025-06-04 12:13:55,863 - INFO - ======================================================================
2025-06-04 12:15:07,918 - INFO - Output:
Current working directory: /Users/lewismatthews/Desktop/Project Geminae/General/SensitivityCausalSWD

Looking for data files...

🎯 Found 20 event files to process:
   1.  1km - event_well_links_with_faults_1km.csv (0.2 MB)
   2.  2km - event_well_links_with_faults_2km.csv (0.8 MB)
   3.  3km - event_well_links_with_faults_3km.csv (2.0 MB)
   4.  4km - event_well_links_with_faults_4km.csv (3.5 MB)
   5.  5km - event_well_links_with_faults_5km.csv (5.2 MB)
   6.  6km - event_well_links_with_faults_6km.csv (7.2 MB)
   7.  7km - event_well_links_with_faults_7km.csv (9.5 MB)
   8.  8km - event_well_links_with_faults_8km.csv (12.3 MB)
   9.  9km - event_well_links_with_faults_9km.csv (15.4 MB)
  10. 10km - event_well_links_with_faults_10km.csv (18.6 MB)
  11. 11km - event_well_links_with_faults_11km.csv (22.0 MB)
  12. 12km - event_well_links_with_faults_12km.csv (25.4 MB)
  13. 13km - event_well_links_with_faults_13km.csv (28.9 MB)
  14. 14km - event_well_links_with_faults_14km.csv (32.5 MB)
  15. 15km - event_well_links_with_faults_15km.csv (36.4 MB)
  16. 16km - event_well_links_with_faults_16km.csv (40.4 MB)
  17. 17km - event_well_links_with_faults_17km.csv (44.5 MB)
  18. 18km - event_well_links_with_faults_18km.csv (49.1 MB)
  19. 19km - event_well_links_with_faults_19km.csv (53.6 MB)
  20. 20km - event_well_links_with_faults_20km.csv (57.9 MB)

================================================================================
BATCH DOWHY EVENT-LEVEL MEDIATION ANALYSIS WITH BOOTSTRAP CI
Started: 2025-06-04 12:13:57
================================================================================

[1/20] Processing event_well_links_with_faults_1km.csv...

============================================================
PROCESSING: event_well_links_with_faults_1km.csv
============================================================
✅ Loaded 1,177 rows
Raw data before aggregation: 1,177 rows
🔄 Aggregating wells by EventID...
✅ Aggregated to 1,058 events
✅ Clean aggregated data: 1,058 events (dropped 0)
   Average wells per event: 1.1
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy event-level analysis complete
   Total effect: +5.720e-06 (p=1.646e-02)
   Direct effect: -9.059e-07 (p=7.140e-01)
   Indirect effect: +6.626e-06
   Proportion mediated: 115.8%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.180

[2/20] Processing event_well_links_with_faults_2km.csv...

============================================================
PROCESSING: event_well_links_with_faults_2km.csv
============================================================
✅ Loaded 4,778 rows
Raw data before aggregation: 4,778 rows
🔄 Aggregating wells by EventID...
✅ Aggregated to 3,162 events
✅ Clean aggregated data: 3,162 events (dropped 0)
   Average wells per event: 1.5
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy event-level analysis complete
   Total effect: +1.753e-05 (p=1.779e-22)
   Direct effect: +3.115e-06 (p=1.038e-01)
   Indirect effect: +1.442e-05
   Proportion mediated: 82.2%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.294

[3/20] Processing event_well_links_with_faults_3km.csv...

============================================================
PROCESSING: event_well_links_with_faults_3km.csv
============================================================
✅ Loaded 11,649 rows
Raw data before aggregation: 11,649 rows
🔄 Aggregating wells by EventID...
✅ Aggregated to 4,921 events
✅ Clean aggregated data: 4,921 events (dropped 0)
   Average wells per event: 2.4
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy event-level analysis complete
   Total effect: +2.132e-05 (p=1.598e-71)
   Direct effect: +1.126e-05 (p=1.072e-17)
   Indirect effect: +1.006e-05
   Proportion mediated: 47.2%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.362

[4/20] Processing event_well_links_with_faults_4km.csv...

============================================================
PROCESSING: event_well_links_with_faults_4km.csv
============================================================
✅ Loaded 20,292 rows
Raw data before aggregation: 20,292 rows
🔄 Aggregating wells by EventID...
✅ Aggregated to 6,192 events
✅ Clean aggregated data: 6,192 events (dropped 0)
   Average wells per event: 3.3
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy event-level analysis complete
   Total effect: +1.724e-05 (p=2.196e-97)
   Direct effect: +9.765e-06 (p=1.036e-27)
   Indirect effect: +7.471e-06
   Proportion mediated: 43.3%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.496

[5/20] Processing event_well_links_with_faults_5km.csv...

============================================================
PROCESSING: event_well_links_with_faults_5km.csv
============================================================
✅ Loaded 30,460 rows
Raw data before aggregation: 30,460 rows
🔄 Aggregating wells by EventID...
✅ Aggregated to 7,102 events
✅ Clean aggregated data: 7,102 events (dropped 0)
   Average wells per event: 4.3
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy event-level analysis complete
   Total effect: +1.154e-05 (p=1.231e-88)
   Direct effect: +5.014e-06 (p=3.156e-16)
   Indirect effect: +6.529e-06
   Proportion mediated: 56.6%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.509

[6/20] Processing event_well_links_with_faults_6km.csv...

============================================================
PROCESSING: event_well_links_with_faults_6km.csv
============================================================
✅ Loaded 42,185 rows
Raw data before aggregation: 42,185 rows
🔄 Aggregating wells by EventID...
✅ Aggregated to 7,943 events
✅ Clean aggregated data: 7,943 events (dropped 0)
   Average wells per event: 5.3
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy event-level analysis complete
   Total effect: +5.865e-06 (p=2.293e-53)
   Direct effect: +1.620e-06 (p=3.042e-05)
   Indirect effect: +4.245e-06
   Proportion mediated: 72.4%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.524

[7/20] Processing event_well_links_with_faults_7km.csv...

============================================================
PROCESSING: event_well_links_with_faults_7km.csv
============================================================
✅ Loaded 55,955 rows
Raw data before aggregation: 55,955 rows
🔄 Aggregating wells by EventID...
✅ Aggregated to 8,653 events
✅ Clean aggregated data: 8,653 events (dropped 0)
   Average wells per event: 6.5
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy event-level analysis complete
   Total effect: +4.951e-06 (p=7.456e-59)
   Direct effect: +1.235e-06 (p=9.186e-05)
   Indirect effect: +3.716e-06
   Proportion mediated: 75.0%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.545

[8/20] Processing event_well_links_with_faults_8km.csv...

============================================================
PROCESSING: event_well_links_with_faults_8km.csv
============================================================
✅ Loaded 72,116 rows
Raw data before aggregation: 72,116 rows
🔄 Aggregating wells by EventID...
✅ Aggregated to 9,231 events
✅ Clean aggregated data: 9,231 events (dropped 0)
   Average wells per event: 7.8
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy event-level analysis complete
   Total effect: +2.142e-06 (p=1.763e-26)
   Direct effect: +1.657e-07 (p=4.123e-01)
   Indirect effect: +1.976e-06
   Proportion mediated: 92.3%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.526

[9/20] Processing event_well_links_with_faults_9km.csv...

============================================================
PROCESSING: event_well_links_with_faults_9km.csv
============================================================
✅ Loaded 90,728 rows
Raw data before aggregation: 90,728 rows
🔄 Aggregating wells by EventID...
✅ Aggregated to 9,658 events
✅ Clean aggregated data: 9,658 events (dropped 0)
   Average wells per event: 9.4
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy event-level analysis complete
   Total effect: +1.848e-06 (p=8.050e-27)
   Direct effect: +1.059e-07 (p=5.433e-01)
   Indirect effect: +1.742e-06
   Proportion mediated: 94.3%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.498

[10/20] Processing event_well_links_with_faults_10km.csv...

============================================================
PROCESSING: event_well_links_with_faults_10km.csv
============================================================
✅ Loaded 110,014 rows
Raw data before aggregation: 110,014 rows
🔄 Aggregating wells by EventID...
✅ Aggregated to 9,928 events
✅ Clean aggregated data: 9,928 events (dropped 0)
   Average wells per event: 11.1
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy event-level analysis complete
   Total effect: +1.835e-06 (p=2.329e-31)
   Direct effect: +1.144e-07 (p=4.750e-01)
   Indirect effect: +1.721e-06
   Proportion mediated: 93.8%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.493

[11/20] Processing event_well_links_with_faults_11km.csv...

============================================================
PROCESSING: event_well_links_with_faults_11km.csv
============================================================
✅ Loaded 130,215 rows
Raw data before aggregation: 130,215 rows
🔄 Aggregating wells by EventID...
✅ Aggregated to 10,079 events
✅ Clean aggregated data: 10,079 events (dropped 0)
   Average wells per event: 12.9
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy event-level analysis complete
   Total effect: +1.633e-06 (p=2.048e-30)
   Direct effect: +9.195e-08 (p=5.215e-01)
   Indirect effect: +1.541e-06
   Proportion mediated: 94.4%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.452

[12/20] Processing event_well_links_with_faults_12km.csv...

============================================================
PROCESSING: event_well_links_with_faults_12km.csv
============================================================
✅ Loaded 150,203 rows
Raw data before aggregation: 150,203 rows
🔄 Aggregating wells by EventID...
✅ Aggregated to 10,179 events
✅ Clean aggregated data: 10,179 events (dropped 0)
   Average wells per event: 14.8
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy event-level analysis complete
   Total effect: +1.276e-06 (p=1.093e-23)
   Direct effect: -5.123e-08 (p=6.840e-01)
   Indirect effect: +1.327e-06
   Proportion mediated: 104.0%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.440

[13/20] Processing event_well_links_with_faults_13km.csv...

============================================================
PROCESSING: event_well_links_with_faults_13km.csv
============================================================
✅ Loaded 170,893 rows
Raw data before aggregation: 170,893 rows
🔄 Aggregating wells by EventID...
✅ Aggregated to 10,286 events
✅ Clean aggregated data: 10,286 events (dropped 0)
   Average wells per event: 16.6
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy event-level analysis complete
   Total effect: +9.934e-07 (p=3.154e-20)
   Direct effect: -4.919e-08 (p=6.375e-01)
   Indirect effect: +1.043e-06
   Proportion mediated: 105.0%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.452

[14/20] Processing event_well_links_with_faults_14km.csv...

============================================================
PROCESSING: event_well_links_with_faults_14km.csv
============================================================
✅ Loaded 192,249 rows
Raw data before aggregation: 192,249 rows
🔄 Aggregating wells by EventID...
✅ Aggregated to 10,380 events
✅ Clean aggregated data: 10,380 events (dropped 0)
   Average wells per event: 18.5
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy event-level analysis complete
   Total effect: +1.070e-06 (p=4.792e-26)
   Direct effect: +7.183e-09 (p=9.409e-01)
   Indirect effect: +1.063e-06
   Proportion mediated: 99.3%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.448

[15/20] Processing event_well_links_with_faults_15km.csv...

============================================================
PROCESSING: event_well_links_with_faults_15km.csv
============================================================
✅ Loaded 215,258 rows
Raw data before aggregation: 215,258 rows
🔄 Aggregating wells by EventID...
✅ Aggregated to 10,429 events
✅ Clean aggregated data: 10,429 events (dropped 0)
   Average wells per event: 20.6
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy event-level analysis complete
   Total effect: +1.008e-06 (p=4.197e-28)
   Direct effect: +1.768e-08 (p=8.383e-01)
   Indirect effect: +9.903e-07
   Proportion mediated: 98.2%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.438

[16/20] Processing event_well_links_with_faults_16km.csv...

============================================================
PROCESSING: event_well_links_with_faults_16km.csv
============================================================
✅ Loaded 238,280 rows
Raw data before aggregation: 238,280 rows
🔄 Aggregating wells by EventID...
✅ Aggregated to 10,488 events
✅ Clean aggregated data: 10,488 events (dropped 0)
   Average wells per event: 22.7
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy event-level analysis complete
   Total effect: +9.294e-07 (p=1.921e-28)
   Direct effect: +2.443e-08 (p=7.565e-01)
   Indirect effect: +9.050e-07
   Proportion mediated: 97.4%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.446

[17/20] Processing event_well_links_with_faults_17km.csv...

============================================================
PROCESSING: event_well_links_with_faults_17km.csv
============================================================
✅ Loaded 263,078 rows
Raw data before aggregation: 263,078 rows
🔄 Aggregating wells by EventID...
✅ Aggregated to 10,527 events
✅ Clean aggregated data: 10,527 events (dropped 0)
   Average wells per event: 25.0
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy event-level analysis complete
   Total effect: +1.001e-06 (p=9.406e-37)
   Direct effect: +8.158e-08 (p=2.703e-01)
   Indirect effect: +9.193e-07
   Proportion mediated: 91.8%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.395

[18/20] Processing event_well_links_with_faults_18km.csv...

============================================================
PROCESSING: event_well_links_with_faults_18km.csv
============================================================
✅ Loaded 290,036 rows
Raw data before aggregation: 290,036 rows
🔄 Aggregating wells by EventID...
✅ Aggregated to 10,565 events
✅ Clean aggregated data: 10,565 events (dropped 0)
   Average wells per event: 27.5
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy event-level analysis complete
   Total effect: +9.928e-07 (p=9.900e-43)
   Direct effect: +1.321e-07 (p=5.109e-02)
   Indirect effect: +8.607e-07
   Proportion mediated: 86.7%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.420

[19/20] Processing event_well_links_with_faults_19km.csv...

============================================================
PROCESSING: event_well_links_with_faults_19km.csv
============================================================
✅ Loaded 316,778 rows
Raw data before aggregation: 316,778 rows
🔄 Aggregating wells by EventID...
✅ Aggregated to 10,606 events
✅ Clean aggregated data: 10,606 events (dropped 0)
   Average wells per event: 29.9
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy event-level analysis complete
   Total effect: +1.048e-06 (p=3.270e-52)
   Direct effect: +1.707e-07 (p=8.103e-03)
   Indirect effect: +8.774e-07
   Proportion mediated: 83.7%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.416

[20/20] Processing event_well_links_with_faults_20km.csv...

============================================================
PROCESSING: event_well_links_with_faults_20km.csv
============================================================
✅ Loaded 342,463 rows
Raw data before aggregation: 342,463 rows
🔄 Aggregating wells by EventID...
✅ Aggregated to 10,635 events
✅ Clean aggregated data: 10,635 events (dropped 0)
   Average wells per event: 32.2
🔄 Running DoWhy mediation analysis...
🔄 Running bootstrap confidence intervals...
🔄 Running DoWhy refutation tests...
🔄 Calculating predictive metrics...
✅ DoWhy event-level analysis complete
   Total effect: +1.071e-06 (p=8.687e-61)
   Direct effect: +2.115e-07 (p=5.335e-04)
   Indirect effect: +8.599e-07
   Proportion mediated: 80.3%
   Bootstrap success rate: 100.0%
   Predictive R²: 0.422

======================================================================================================================================================
📊 COMPREHENSIVE DOWHY EVENT-LEVEL MEDIATION ANALYSIS SUMMARY
======================================================================================================================================================

🎯 CAUSAL EFFECTS BY RADIUS (DOWHY EVENT-LEVEL AGGREGATED):
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Radius  Events Avg Wells  Total Effect               95% CI  Direct Effect               95% CI    Indirect  % Med Causal R²  Pred R²
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1km   1,058      1.1 +5.720e-06 [+6.21e-07,+3.94e-05]  -9.059e-07 [-3.51e-06,+2.08e-05] +6.63e-06 115.8%    0.059   0.180
   2km   3,162      1.5 +1.753e-05 [+9.59e-06,+3.64e-05]  +3.115e-06 [-6.44e-07,+1.47e-05] +1.44e-05  82.2%    0.045   0.294
   3km   4,921      2.4 +2.132e-05 [+1.56e-05,+2.83e-05]  +1.126e-05 [+6.31e-06,+1.78e-05] +1.01e-05  47.2%    0.127   0.362
   4km   6,192      3.3 +1.724e-05 [+1.41e-05,+2.09e-05]  +9.765e-06 [+7.38e-06,+1.29e-05] +7.47e-06  43.3%    0.182   0.496
   5km   7,102      4.3 +1.154e-05 [+9.50e-06,+1.44e-05]  +5.014e-06 [+3.40e-06,+7.18e-06] +6.53e-06  56.6%    0.219   0.509
   6km   7,943      5.3 +5.865e-06 [+4.20e-06,+8.10e-06]  +1.620e-06 [+6.26e-07,+3.09e-06] +4.25e-06  72.4%    0.244   0.524
   7km   8,653      6.5 +4.951e-06 [+3.70e-06,+6.82e-06]  +1.235e-06 [+5.95e-07,+2.35e-06] +3.72e-06  75.0%    0.297   0.545
   8km   9,231      7.8 +2.142e-06 [+1.35e-06,+3.07e-06]  +1.657e-07 [-1.88e-07,+6.07e-07] +1.98e-06  92.3%    0.318   0.526
   9km   9,658      9.4 +1.848e-06 [+1.29e-06,+2.44e-06]  +1.059e-07 [-2.00e-07,+4.64e-07] +1.74e-06  94.3%    0.335   0.498
  10km   9,928     11.1 +1.835e-06 [+1.42e-06,+2.82e-06]  +1.144e-07 [-1.13e-07,+6.06e-07] +1.72e-06  93.8%    0.333   0.493
  11km  10,079     12.9 +1.633e-06 [+1.10e-06,+2.12e-06]  +9.195e-08 [-1.79e-07,+4.01e-07] +1.54e-06  94.4%    0.315   0.452
  12km  10,179     14.8 +1.276e-06 [+9.19e-07,+1.67e-06]  -5.123e-08 [-2.35e-07,+1.41e-07] +1.33e-06 104.0%    0.301   0.440
  13km  10,286     16.6 +9.934e-07 [+6.82e-07,+1.33e-06]  -4.919e-08 [-1.81e-07,+1.79e-07] +1.04e-06 105.0%    0.288   0.452
  14km  10,380     18.5 +1.070e-06 [+8.02e-07,+1.45e-06]  +7.183e-09 [-8.89e-08,+1.19e-07] +1.06e-06  99.3%    0.277   0.448
  15km  10,429     20.6 +1.008e-06 [+7.14e-07,+1.32e-06]  +1.768e-08 [-1.10e-07,+1.09e-07] +9.90e-07  98.2%    0.268   0.438
  16km  10,488     22.7 +9.294e-07 [+7.24e-07,+1.18e-06]  +2.443e-08 [-7.44e-08,+1.39e-07] +9.05e-07  97.4%    0.256   0.446
  17km  10,527     25.0 +1.001e-06 [+7.77e-07,+1.30e-06]  +8.158e-08 [-3.06e-08,+2.13e-07] +9.19e-07  91.8%    0.246   0.395
  18km  10,565     27.5 +9.928e-07 [+7.68e-07,+1.33e-06]  +1.321e-07 [+2.79e-08,+2.33e-07] +8.61e-07  86.7%    0.236   0.420
  19km  10,606     29.9 +1.048e-06 [+8.86e-07,+1.39e-06]  +1.707e-07 [+1.02e-07,+3.16e-07] +8.77e-07  83.7%    0.226   0.416
  20km  10,635     32.2 +1.071e-06 [+8.55e-07,+1.34e-06]  +2.115e-07 [+1.38e-07,+3.45e-07] +8.60e-07  80.3%    0.216   0.422
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

📈 STATISTICAL SIGNIFICANCE & QUALITY METRICS:
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Radius  Total p-val  Direct p-val  Path a p-val  Path b p-val  Bootstrap    VIF
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1km 1.65e-02*   7.14e-01    3.13e-31*** 2.57e-14***   100.0%  3.33
   2km 1.78e-22*** 1.04e-01    1.57e-157*** 3.40e-60***   100.0%  2.48
   3km 1.60e-71*** 1.07e-17*** 7.53e-291*** 9.50e-55***   100.0%  2.42
   4km 2.20e-97*** 1.04e-27*** 0.00e+00*** 1.26e-70***   100.0%  2.56
   5km 1.23e-88*** 3.16e-16*** 0.00e+00*** 5.20e-122***   100.0%  2.75
   6km 2.29e-53*** 3.04e-05*** 7.37e-264*** 1.36e-177***   100.0%  2.68
   7km 7.46e-59*** 9.19e-05*** 0.00e+00*** 1.69e-182***   100.0%  2.78
   8km 1.76e-26*** 4.12e-01    2.66e-223*** 7.97e-192***   100.0%  2.72
   9km 8.05e-27*** 5.43e-01    3.46e-247*** 1.35e-190***   100.0%  2.95
  10km 2.33e-31*** 4.75e-01    1.22e-283*** 5.79e-198***   100.0%  3.24
  11km 2.05e-30*** 5.21e-01    7.77e-261*** 2.59e-216***   100.0%  3.43
  12km 1.09e-23*** 6.84e-01    1.44e-215*** 3.03e-250***   100.0%  3.61
  13km 3.15e-20*** 6.38e-01    1.51e-161*** 1.37e-296***   100.0%  3.78
  14km 4.79e-26*** 9.41e-01    2.78e-162*** 0.00e+00***   100.0%  4.03
  15km 4.20e-28*** 8.38e-01    3.69e-155*** 0.00e+00***   100.0%  4.30
  16km 1.92e-28*** 7.56e-01    1.79e-146*** 0.00e+00***   100.0%  4.63
  17km 9.41e-37*** 2.70e-01    1.35e-163*** 0.00e+00***   100.0%  5.03
  18km 9.90e-43*** 5.11e-02    8.11e-168*** 0.00e+00***   100.0%  5.42
  19km 3.27e-52*** 8.10e-03**  1.23e-187*** 0.00e+00***   100.0%  5.87
  20km 8.69e-61*** 5.34e-04*** 5.76e-202*** 0.00e+00***   100.0%  6.29
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Significance: *** p<0.001, ** p<0.01, * p<0.05

🔍 DOWHY REFUTATION TESTS:
────────────────────────────────────────────────────────────────────────────────────────────────────
Radius     Original      Placebo       Subset  Random Conf          Status
────────────────────────────────────────────────────────────────────────────────────────────────────
   1km +5.72e-06 +1.80e-07 +7.51e-06 +5.62e-06      ⚠️ CAUTION
   2km +1.75e-05 -4.57e-08 +1.85e-05 +1.74e-05          ✅ PASS
   3km +2.13e-05 -4.23e-08 +2.17e-05 +1.95e-05          ✅ PASS
   4km +1.72e-05 +5.64e-08 +1.73e-05 +1.60e-05          ✅ PASS
   5km +1.15e-05 -1.01e-07 +1.16e-05 +1.08e-05          ✅ PASS
   6km +5.86e-06 -4.84e-09 +5.88e-06 +5.53e-06          ✅ PASS
   7km +4.95e-06 -6.03e-09 +4.95e-06 +4.65e-06          ✅ PASS
   8km +2.14e-06 -3.59e-08 +2.12e-06 +2.01e-06          ✅ PASS
   9km +1.85e-06 +1.52e-08 +1.82e-06 +1.69e-06          ✅ PASS
  10km +1.84e-06 +8.78e-10 +1.87e-06 +1.73e-06          ✅ PASS
  11km +1.63e-06 -2.62e-09 +1.61e-06 +1.55e-06          ✅ PASS
  12km +1.28e-06 +6.31e-09 +1.28e-06 +1.23e-06          ✅ PASS
  13km +9.93e-07 -9.37e-09 +9.98e-07 +9.11e-07          ✅ PASS
  14km +1.07e-06 -1.03e-08 +1.09e-06 +1.01e-06          ✅ PASS
  15km +1.01e-06 +6.27e-09 +1.02e-06 +9.46e-07          ✅ PASS
  16km +9.29e-07 +5.88e-09 +9.24e-07 +8.77e-07          ✅ PASS
  17km +1.00e-06 -6.44e-09 +9.93e-07 +9.44e-07          ✅ PASS
  18km +9.93e-07 +5.02e-09 +1.00e-06 +8.21e-07          ✅ PASS
  19km +1.05e-06 +9.63e-10 +1.05e-06 +9.76e-07          ✅ PASS
  20km +1.07e-06 -7.17e-09 +1.07e-06 +9.75e-07          ✅ PASS
────────────────────────────────────────────────────────────────────────────────────────────────────

🔍 KEY INSIGHTS:
──────────────────────────────────────────────────────────────────────
• Strongest total effect:    3km (+2.132e-05)
• Highest mediation:         1km (115.8%)
• Best causal model fit:     9km (R²=0.335)
• Best predictive fit:       7km (R²=0.545)
• Event sample size range:   1,058 - 10,635 events
• Wells per event range:     1.1 - 32.2
• Near-field mediation:      69.0% (≤5km)
• Far-field mediation:       94.1% (≥10km)
• Average bootstrap success: 100.0%
• Average VIF:               3.72
• Refutation tests passed:   19/20 (95.0%)
──────────────────────────────────────────────────────────────────────

📊 EVENT-LEVEL AGGREGATION BENEFITS:
──────────────────────────────────────────────────
• Reduced noise from duplicate earthquake magnitudes
• Accounts for multiple wells affecting single events
• Better signal-to-noise ratio for causal inference
• Well count included as additional confounder
• More interpretable units of analysis (events vs well-pairs)
──────────────────────────────────────────────────

💾 Results saved to: dowhy_event_level_mediation_20250604_121507.csv
📝 Methodology notes saved to: dowhy_event_methodology_notes_20250604_121507.txt

================================================================================
DoWhy Event-Level Analysis completed: 2025-06-04 12:15:07
================================================================================

2025-06-04 12:15:07,918 - INFO - ✓ Completed dowhy_ci_aggregated.py in 72.06 seconds

2025-06-04 12:15:07,918 - INFO - 
=====================================================================
 P I P E L I N E   C O M P L E T E
=====================================================================
End time: 2025-06-04 12:15:07
Total duration: 0h 28m 45s
=====================================================================

KEY FINDINGS:
- Injection volume causes seismic activity through two mechanisms
- Near-field (≤5km): Mixed direct mechanical and pressure-mediated effects  
- Far-field (>10km): Exclusively pressure-mediated effects
- Strongest effects: 3-4km radius shows 20× stronger effects than 20km
- Optimal monitoring: 5-7km radius balances effect size and predictive accuracy
- Policy implication: Spatially-targeted regulation within 7km of faults recommended
=====================================================================
    
